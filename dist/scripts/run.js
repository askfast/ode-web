define(["app","config","locals"],function(e,t,n){e.run(function(e,r,i,s,o,u,a,f,l,c,h){(h("app").get("periods")==null||h("app").get("periods").value==null)&&o.registerPeriods(),e.StandBy=e.StandBy||{config:t,session:{},resources:{},environment:{domain:"",states:[],divisions:[]},settings:{}},e.StandBy.guard={},!_.isUndefined(e.StandBy.session)&&s.check()&&(e.StandBy.session=angular.fromJson(sessionStorage.getItem("session"))),!_.isUndefined(e.StandBy.resources)&&h("user").get("resources")!=""&&(e.StandBy.resources=h("user").get("resources")),!_.isUndefined(e.StandBy.environment.domain)&&h("environment").get("domain")!=""&&(e.StandBy.environment.domain=h("environment").get("domain")),!_.isUndefined(e.StandBy.environment.states)&&h("environment").get("states")!=""&&(e.StandBy.environment.states=h("environment").get("states"),_.each(h("environment").get("states"),function(t){e.StandBy.config.timeline.config.states[t]=e.StandBy.config.statesall[t]})),!_.isUndefined(e.StandBy.environment.divisions)&&h("environment").get("divisions")!=""&&(e.StandBy.environment.divisions=h("environment").get("divisions")),h("smartAlarm").get("guard")?e.StandBy.guard=h("smartAlarm").get("guard"):e.StandBy.guard={monitor:"",role:"",currentState:"",currentStateClass:""},console.log("StandBy ->",e.StandBy);var p=h("settings").get("mine");p?e.app.settings=p:(e.app.settings={language:t.lang},h("settings").save("mine",e.app.settings)),e.StandBy.config=t,e.StandBy.config.init(),e.changeLanguage=function(t){e.ui=n.ui[t],e.app.settings.language=t},e.ui=n.ui[e.StandBy.config.lang];var d=h("notifications").get("registeredNotifications");d?e.registeredNotifications=d:h("notifications").save("registeredNotifications",{timeLineDragging:!0}),e.registerNotification=function(t,n){e.registeredNotifications[t]=n,h("notifications").save("registeredNotifications",e.registeredNotifications)},e.app.unreadMessages||u.unreadCount(),e.fireDeleteRequest=function(t){t.section=="groups"&&e.$broadcast("fireGroupDelete",{id:t.id})},$("#notification").removeClass("ng-cloak"),e.fixStyles=function(){e.timelineLoaded=!1;var t=$(".tabs-left .nav-tabs").height();$.each($(".tab-content").children(),function(){var e=$(this),n=$(this).attr("id"),r=$(".tabs-left .tab-content #"+n).height();t>r&&$(".tabs-left .tab-content #"+n).css({height:$(".tabs-left .nav-tabs").height()-41})}),($.os.mac||$.os.linux)&&$(".nav-tabs-app li a span").css({paddingTop:"10px",marginBottom:"0px"})},e.fullScreen=function(){screenfull.toggle($("html")[0])},t.profile.mobileApp.status||$("#copyrights span.muted").css({right:0}),$(".nav a").on("click",function(){$(".btn-navbar").click()}),e.resetPhoneNumberChecker=function(){e.phoneNumberParsed={},e.phoneNumberParsed.result=!1},e.resetPhoneNumberChecker(),e.phoneNumberParser=function(t){if(t!="")if(t&&t.length>0){var n,r;n=r=phoneNumberParser(t,"NL"),e.phoneNumberParsed.result=!0;if(n){var i=e.ui.errors.phone.notValid,s=e.ui.errors.phone.invalidCountry,o;if(n.error)e.phoneNumberParsed={result:!1,message:i};else if(!n.validation.isPossibleNumber){switch(n.validation.isPossibleNumberWithReason){case"INVALID_COUNTRY_CODE":o=s;break;case"TOO_SHORT":o=i+e.ui.errors.phone.tooShort;break;case"TOO_LONG":o=i+e.ui.errors.phone.tooLong}e.phoneNumberParsed={result:!1,message:o}}else n.validation.isValidNumber?n.validation.isValidNumberForRegion?(e.phoneNumberParsed={result:!0,message:e.ui.success.phone.message+n.validation.phoneNumberRegion+e.ui.success.phone.as+n.validation.getNumberType},$("#inputPhoneNumber").removeClass("error")):e.phoneNumberParsed={result:!1,message:s}:e.phoneNumberParsed={result:!1,message:i}}e.phoneNumberParsed.all=r}else e.phoneNumberParsed.result=!0,delete e.phoneNumberParsed.message,$("#inputPhoneNumber").removeClass("error")},e.unite=function(e){var t="";return _.each(e,function(e){t+=e}),t}})});