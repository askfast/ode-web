/**
 * AngularStrap - Twitter Bootstrap directives for AngularJS
 * @version v0.7.0 - 2013-03-11
 * @link http://mgcrea.github.com/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

angular.module("$strap.config",[]).value("$strap.config",{}),angular.module("$strap.filters",["$strap.config"]),angular.module("$strap.directives",["$strap.config"]),angular.module("$strap",["$strap.filters","$strap.directives","$strap.config"]),angular.module("$strap.directives").directive("bsAlert",["$parse","$timeout","$compile",function(e,t,n){return{restrict:"A",link:function(t,r,i){var s=e(i.bsAlert),o=(s.assign,s(t));i.bsAlert?t.$watch(i.bsAlert,function(e,s){o=e,r.html((e.title?"<strong>"+e.title+"</strong>&nbsp;":"")+e.content||""),e.closed&&r.hide(),n(r.contents())(t),(e.type||s.type)&&(s.type&&r.removeClass("alert-"+s.type),e.type&&r.addClass("alert-"+e.type)),(angular.isUndefined(i.closeButton)||"0"!==i.closeButton&&"false"!==i.closeButton)&&r.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>')},!0):(angular.isUndefined(i.closeButton)||"0"!==i.closeButton&&"false"!==i.closeButton)&&r.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>'),r.addClass("alert").alert(),r.hasClass("fade")&&(r.removeClass("in"),setTimeout(function(){r.addClass("in")}));var u=i.ngRepeat&&i.ngRepeat.split(" in ").pop();r.on("close",function(e){var n;u?(e.preventDefault(),r.removeClass("in"),n=function(){r.trigger("closed"),t.$parent&&t.$parent.$apply(function(){for(var e=u.split("."),n=t.$parent,r=0;e.length>r;++r)n&&(n=n[e[r]]);n&&n.splice(t.$index,1)})},$.support.transition&&r.hasClass("fade")?r.on($.support.transition.end,n):n()):o&&(e.preventDefault(),r.removeClass("in"),n=function(){r.trigger("closed"),t.$apply(function(){o.closed=!0})},$.support.transition&&r.hasClass("fade")?r.on($.support.transition.end,n):n())})}}}]),angular.module("$strap.directives").directive("bsButton",["$parse","$timeout",function(e){return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){if(s){r.parent('[data-toggle="buttons-checkbox"], [data-toggle="buttons-radio"]').length||r.attr("data-toggle","button");var o=!!n.$eval(i.ngModel);o&&r.addClass("active"),n.$watch(i.ngModel,function(e,t){var n=!!e,i=!!t;n!==i?$.fn.button.Constructor.prototype.toggle.call(u):n&&!o&&r.addClass("active")})}r.hasClass("btn")||r.on("click.button.data-api",function(){r.button("toggle")}),r.button();var u=r.data("button");u.toggle=function(){if(!s)return $.fn.button.Constructor.prototype.toggle.call(this);var i=r.parent('[data-toggle="buttons-radio"]');i.length?(r.siblings("[ng-model]").each(function(r,i){e($(i).attr("ng-model")).assign(n,!1)}),n.$digest(),s.$modelValue||(s.$setViewValue(!s.$modelValue),n.$digest())):n.$apply(function(){s.$setViewValue(!s.$modelValue)})}}}}]).directive("bsButtonsCheckbox",["$parse",function(){return{restrict:"A",require:"?ngModel",compile:function(e){e.attr("data-toggle","buttons-checkbox").find("a, button").each(function(e,t){angular.element(t).attr("bs-button","")})}}}]).directive("bsButtonsRadio",["$parse",function(){return{restrict:"A",require:"?ngModel",compile:function(e,t){return e.attr("data-toggle","buttons-radio"),t.ngModel||e.find("a, button").each(function(e,t){angular.element(t).attr("bs-button","")}),function(e,t,n,r){r&&(t.find("[value]").button().filter('[value="'+e.$eval(n.ngModel)+'"]').addClass("active"),t.on("click.button.data-api",function(t){e.$apply(function(){r.$setViewValue(angular.element(t.target).closest("button").attr("value"))})}),e.$watch(n.ngModel,function(r,i){if(r!==i){var s=t.find('[value="'+e.$eval(n.ngModel)+'"]');s.length&&$.fn.button.Constructor.prototype.toggle.call(s.data("button"))}}))}}}}]),angular.module("$strap.directives").directive("bsButtonSelect",["$parse","$timeout",function(e){return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){var o=e(i.bsButtonSelect);o.assign,s&&(r.text(n.$eval(i.ngModel)),n.$watch(i.ngModel,function(e){r.text(e)}));var u,a,f,l;r.bind("click",function(){u=o(n),a=s?n.$eval(i.ngModel):r.text(),f=u.indexOf(a),l=f>u.length-2?u[0]:u[f+1],console.warn(u,l),n.$apply(function(){r.text(l),s&&s.$setViewValue(l)})})}}}]),angular.module("$strap.directives").directive("bsDatepicker",["$timeout",function(){var e="ontouchstart"in window&&!window.navigator.userAgent.match(/PhantomJS/i),t={"/":"[\\/]","-":"[-]",".":"[.]",dd:"(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))",d:"(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))",mm:"(?:[0]?[1-9]|[1][012])",m:"(?:[0]?[1-9]|[1][012])",yyyy:"(?:(?:[1]{1}[0-9]{1}[0-9]{1}[0-9]{1})|(?:[2]{1}[0-9]{3}))(?![[0-9]])",yy:"(?:(?:[0-9]{1}[0-9]{1}))(?![[0-9]])"};return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){var o=function(e,n){n||(n={});var r=e,i=t;return angular.forEach(i,function(e,t){r=r.split(t).join(e)}),RegExp("^"+r+"$",["i"])},u=e?"yyyy/mm/dd":o(i.dateFormat||"mm/dd/yyyy");s&&s.$parsers.unshift(function(e){return!e||u.test(e)?(s.$setValidity("date",!0),e):(s.$setValidity("date",!1),void 0)});var a=r.next('[data-toggle="datepicker"]');if(a.length&&a.on("click",function(){e?r.trigger("focus"):r.datepicker("show")}),e&&"text"===r.prop("type"))r.prop("type","date"),r.on("change",function(){n.$apply(function(){s.$setViewValue(r.val())})});else{s&&r.on("changeDate",function(){n.$apply(function(){s.$setViewValue(r.val())})});var f=r.closest(".popover");f&&f.on("hide",function(){var e=r.data("datepicker");e&&(e.picker.remove(),r.data("datepicker",null))}),r.attr("data-toggle","datepicker"),r.datepicker({autoclose:!0,forceParse:i.forceParse||!1,language:i.language||"en"})}}}}]),angular.module("$strap.directives").directive("bsDropdown",["$parse","$compile",function(e,t){var n=Array.prototype.slice,r='<ul class="dropdown-menu" role="menu" aria-labelledby="drop1"><li ng-repeat="item in items" ng-class="{divider: !!item.divider, \'dropdown-submenu\': !!item.submenu && item.submenu.length}"><a ng-hide="!!item.divider" tabindex="-1" ng-href="{{item.href}}" ng-click="{{item.click}}" target="{{item.target}}" ng-bind-html-unsafe="item.text"></a></li></ul>',i=function(e,n,i){for(var u,a,f,l=0,c=e.length;c>l;l++)(u=e[l].submenu)&&(f=i.$new(),f.items=u,a=t(r)(f),a=a.appendTo(n.children("li:nth-child("+(l+1)+")")),s(u,a,f))},s=function(){var e=n.call(arguments);setTimeout(function(){i.apply(null,e)})};return{restrict:"EA",scope:!0,link:function(n,i,u){var a=e(u.bsDropdown);n.items=a(n);var f=t(r)(n);s(n.items,f,n),f.insertAfter(i),i.addClass("dropdown-toggle").attr("data-toggle","dropdown")}}}]),angular.module("$strap.directives").directive("bsModal",["$parse","$compile","$http","$timeout","$q","$templateCache",function(e,t,n,r,i,s){return{restrict:"A",scope:!0,link:function(u,f,l){var c=e(l.bsModal),h=(c.assign,c(u));i.when(s.get(h)||n.get(h,{cache:!0})).then(function(e){angular.isObject(e)&&(e=e.data);var n=c(u).replace(".html","").replace(/[\/|\.|:]/g,"-")+"-"+u.$id,i=angular.element('<div class="modal hide" tabindex="-1"></div>').attr("id",n).attr("data-backdrop",l.backdrop||!0).attr("data-keyboard",l.keyboard||!0).addClass(l.modalClass?"fade "+l.modalClass:"fade").html(e);angular.element("body").append(i),f.attr("href","#"+n).attr("data-toggle","modal"),r(function(){t(i)(u)}),u._modal=function(e){i.modal(e)},u.hide=function(){i.modal("hide")},u.show=function(){i.modal("show")},u.dismiss=u.hide})}}}]),angular.module("$strap.directives").directive("bsNavbar",["$location",function(e){return{restrict:"A",link:function(n,r){n.$watch(function(){return e.path()},function(e){r.find("li[data-match-route]").each(function(n,r){var i=angular.element(r),s=i.attr("data-match-route"),o=RegExp("^"+s+"$",["i"]);o.test(e)?i.addClass("active"):i.removeClass("active")})})}}}]),angular.module("$strap.directives").directive("bsPopover",["$parse","$compile","$http","$timeout","$q","$templateCache",function(e,t,n,r,i,s){return angular.element("body").on("keyup",function(e){27===e.keyCode&&angular.element(".popover.in").each(function(){angular.element(this).popover("hide")})}),{restrict:"A",scope:!0,link:function(r,u,f){var l=e(f.bsPopover),c=(l.assign,l(r)),h={};angular.isObject(c)&&(h=c),i.when(h.content||s.get(c)||n.get(c,{cache:!0})).then(function(e){angular.isObject(e)&&(e=e.data),f.unique&&u.on("show",function(){angular.element(".popover.in").each(function(){var e=angular.element(this),t=e.data("popover");t&&!t.$element.is(u)&&e.popover("hide")})}),f.hide&&r.$watch(f.hide,function(e,t){e?n.hide():e!==t&&n.show()}),u.popover(angular.extend({},h,{content:e,html:!0}));var n=u.data("popover");n.hasContent=function(){return this.getTitle()||e},n.getPosition=function(){var e=$.fn.popover.Constructor.prototype.getPosition.apply(this,arguments);return t(this.$tip)(r),r.$digest(),this.$tip.data("popover",this),e},r._popover=function(e){u.popover(e)},r.hide=function(){u.popover("hide")},r.show=function(){u.popover("show")},r.dismiss=r.hide})}}}]),angular.module("$strap.directives").directive("bsTabs",["$parse","$compile",function(e,t){return{restrict:"A",link:function(e,n){var r=['<ul class="nav nav-tabs">',"</ul>"],i=['<div class="tab-content">',"</div>"];n.find("[data-tab]").each(function(t){var n=angular.element(this),s="tab-"+e.$id+"-"+t,o=n.hasClass("active"),u=n.hasClass("fade"),f=e.$eval(n.data("tab"));r.splice(t+1,0,"<li"+(o?' class="active"':"")+'><a href="#'+s+'" data-toggle="tab">'+f+"</a></li>"),i.splice(t+1,0,'<div class="tab-pane '+n.attr("class")+(u&&o?" in":"")+'" id="'+s+'">'+this.innerHTML+"</div>")}),n.html(r.join("")+i.join("")),t(n.children("div.tab-content"))(e)}}}]),angular.module("$strap.directives").directive("bsTimepicker",["$timeout",function(){var e="((?:(?:[0-1][0-9])|(?:[2][0-3])|(?:[0-9])):(?:[0-5][0-9])(?::[0-5][0-9])?(?:\\s?(?:am|AM|pm|PM))?)";return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){s&&r.on("change",function(){n.$apply(function(){s.$setViewValue(r.val())})});var o=RegExp("^"+e+"$",["i"]);s.$parsers.unshift(function(e){return!e||o.test(e)?(s.$setValidity("time",!0),e):(s.$setValidity("time",!1),void 0)});var u=r.closest(".popover");u&&u.on("hide",function(){var e=r.data("timepicker");e&&(e.$widget.remove(),r.data("timepicker",null))}),r.attr("data-toggle","timepicker"),r.timepicker()}}}]),angular.module("$strap.directives").directive("bsTooltip",["$parse","$compile",function(e){return{restrict:"A",scope:!0,link:function(n,r,i){var s=e(i.bsTooltip),o=(s.assign,s(n));n.$watch(i.bsTooltip,function(e,t){e!==t&&(o=e)}),i.unique&&r.on("show",function(){angular.element(".tooltip.in").each(function(){var e=angular.element(this),t=e.data("tooltip");t&&!t.$element.is(r)&&e.tooltip("hide")})}),r.tooltip({title:function(){return angular.isFunction(o)?o.apply(null,arguments):o},html:!0});var u=r.data("tooltip");u.show=function(){var e=$.Event("show");if(this.$element.trigger(e),!e.isDefaultPrevented()){var t=$.fn.tooltip.Constructor.prototype.show.apply(this,arguments);return this.tip().data("tooltip",this),t}},u.hide=function(){var e=$.Event("hide");return this.$element.trigger(e),e.isDefaultPrevented()?void 0:$.fn.tooltip.Constructor.prototype.hide.apply(this,arguments)},n._tooltip=function(e){r.tooltip(e)},n.hide=function(){r.tooltip("hide")},n.show=function(){r.tooltip("show")},n.dismiss=n.hide}}}]),angular.module("$strap.directives").directive("bsTypeahead",["$parse",function(e){return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){var o=e(i.bsTypeahead),u=(o.assign,o(n));n.$watch(i.bsTypeahead,function(e,t){e!==t&&(u=e)}),r.attr("data-provide","typeahead"),r.typeahead({source:function(){return angular.isFunction(u)?u.apply(null,arguments):u},minLength:i.minLength||1,items:i.items,updater:function(e){return s&&n.$apply(function(){s.$setViewValue(e)}),e}});var a=r.data("typeahead");a.lookup=function(){var e;return this.query=this.$element.val()||"",this.query.length<this.options.minLength?this.shown?this.hide():this:(e=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source,e?this.process(e):this)},"0"===i.minLength&&setTimeout(function(){r.on("focus",function(){0===r.val().length&&setTimeout(r.typeahead.bind(r,"lookup"),200)})})}}}]);