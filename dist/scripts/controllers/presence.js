define(["controllers/controllers","config"],function(e,t){e.controller("presence",["$scope","$rootScope","$q","$window","$location","$timeout","Dashboard","Dater","Settings","Profile","Groups","Announcer","Network","Slots","Store","$http",function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){t.notifier.destroy();if(!v.defaults.headers.common["X-SESSION_ID"]){var m=d("session").get("sessionId");v.defaults.headers.common["X-SESSION_ID"]=m.id}t.fixStyles(),$(".navbar").hide(),$("#footer").hide(),$("#watermark").css({bottom:"-10px"});var g=d("network").get("groups"),y=angular.fromJson(d("user").get("resources").settingsWebPaige),b=[];e.loadingPresence=!0,_.each(g,function(e){e.uuid!="all"&&b.push(e)});var w,E=function(e){var t={};return _.each(e,function(e){e.resources.groups?_.each(g,function(n){e.resources.groups[0].uuid===n.uuid&&(typeof t[n.uuid]=="undefined"&&(t[n.uuid]=[]),e.resources.groups[0].name=n.name,t[n.uuid].push(e))}):(typeof t["ungrouped"]=="undefined"&&(t.ungrouped=[]),t.ungrouped.push(e))}),t};e.checkPresence=function(){w=d("network").get("unique");var t=[];_.each(w,function(e){e.resources&&e.resources.currentPresence&&(e.resources.groups&&e.resources.groups.length>1&&(e.resources.groups=e.resources.groups.slice(0,1)),t.push(e))}),e.loadingPresence=!1,e.present=E(t)},e.checkPresence(),r.setInterval(function(){h.population().then(function(t){e.checkPresence()})},t.StandBy.config.timers.TV_SYNC)}])});