define(["directives/directives"],function(e){e.directive("chosen",function(){var e=function(e,t){e.$watch("receviersList",function(){t.trigger("liszt:updated")}),e.$watch("message.receviers",function(){angular.element(t[0]).trigger("liszt:updated")}),t.chosen()};return{restrict:"A",link:e}}),e.directive("uploader",[function(){return{restrict:"E",scope:{action:"@"},controller:["$scope","$rootScope","Session",function(e,t,n){e.progress=0,e.avatar="",e.uploadLabel=t.ui.profile.click2upload;var r=n.get();r&&(e.sessionId=r),e.sendFile=function(t){var n=angular.element(t).parents("form");if(angular.element(t).val()=="")return!1;n.attr("action",e.action),e.$apply(function(){e.progress=0}),n.ajaxSubmit({type:"POST",headers:{"X-SESSION_ID":e.sessionId},uploadProgress:function(t,n,r,i){e.$apply(function(){e.progress=i})},error:function(e,t,r,i){n.removeAttr("action"),console.log("response : ",r)},success:function(r,i,s,o){var u=angular.element(t).val().split("\\"),a=u[u.length-1];n.removeAttr("action"),e.$apply(function(){e.avatar=a,console.log(e,e.$parent.data.uuid),e.$parent.data.clientId?e.$parent.$root.avatarChange(e.$parent.data.clientId):e.$parent.data.uuid&&e.$parent.$root.avatarChange(e.$parent.data.uuid);var t="",n=$(".roundedPicLarge").attr("style"),r=0;try{r=parseInt(n.split("?")[1].split("&")[0].split("=")[1],10)}catch(i){console.log(i)}var s=parseInt(r,10)+e.$parent.$root.getAvatarChangeTimes(e.$parent.data.uuid),o=n.replace("width="+r,"width="+s);$(".roundedPicLarge").attr("style",o)})}})}}],link:function(e,t,n,r){t.find(".fake-uploader").click(function(){t.find('input[type="file"]').click()})},replace:!1,templateUrl:"views/uploader.html"}}]),e.directive("profile",[function(){return{restrict:"E",scope:{memberId:"@"},controller:["$scope",function(e){e.loadMember=function(e){}}],link:function(e,t,n,r){console.log("profile directive ->",n.memberId)},replace:!1,templateUrl:"views/profileTemplate.html"}}]),e.directive("ngenter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){t.which===13&&(e.$apply(function(){e.$eval(n.ngenter)}),t.preventDefault())})}}),e.directive("backImg",function(){return function(e,t,n){var r=n.backImg;t.css({"background-image":"url("+r+")","background-size":"cover"})}}),e.directive("linkIconHovered",function(){return{link:function(e,t,n){t.parent().bind("mouseenter",function(){t.removeClass("icon-link"),t.addClass("icon-link2")}),t.parent().bind("mouseleave",function(){t.removeClass("icon-link2"),t.addClass("icon-link")})}}})});