define(["services/services","config"],function(e,t){e.factory("Stats",[function(){return{aggs:function(e,t,n){var r={less:0,even:0,more:0},i={less:0,even:0,more:0,total:0},s=0;return angular.forEach(e,function(e){var o=e.start;o<t&&(o=t);var u=e.end;u>n&&(u=n);var a=u-o;e.diff<0?r.less+=a:e.diff==0?r.even+=a:r.more+=a,s+=a,e.diff<0?i.less+=a:e.diff==0?i.even+=a:i.more+=a,i.total+=a}),{ratios:{less:Math.round(r.less/s*100),even:Math.round(r.even/s*100),more:Math.round(r.more/s*100)},durations:i}},pies:function(e,t,n){var r={less:0,even:0,more:0},i=0;return angular.forEach(e,function(e){var s=e.start;s<t&&(s=t);var o=e.end;o>n&&(o=n);var u=o-s;e.diff<0?r.less+=u:e.diff==0?r.even+=u:r.more+=u,i+=u}),i==0&&(i=n-t),{less:Math.round(r.less/i*100),even:Math.round(r.even/i*100),more:Math.round(r.more/i*100)}},member:function(e,t,n){var r={},i=0;angular.forEach(e,function(e){var s=e.start;s<t&&(s=t);var o=e.end;o>n&&(o=n);var u=o-s;r[e.text]?r[e.text]+=u:r[e.text]=u,i+=u});var s=n-t-i;s>0&&(r["com.ask-cs.State.NoPlanning"]=s),i+=s;var o=[];return angular.forEach(r,function(e,t){o.push({state:t,ratio:e/i*100})}),o}}}])});