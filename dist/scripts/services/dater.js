define(["services/services"],function(e){e.factory("Dater",["$rootScope","Store",function(e,t){return{current:{today:function(){return Date.today().getDayOfYear()+1},week:function(){Date.prototype.getWeek=function(){var e=new Date;e.setFullYear(this.getFullYear(),this.getMonth(),this.getDate());var t=e.getDay();t==0&&(t=7),e.setDate(e.getDate()+(4-t));var n=e.getFullYear(),r=Math.floor((e.getTime()-new Date(n,0,1,-6))/864e5),i=1+Math.floor(r/7);return i};if((new Date).getWeek())return(new Date).getWeek();console.log("Date getWeek does not exist !")},month:function(){return(new Date).getMonth()+1},year:function(){return(new Date).toString("yyyy")}},readable:{date:function(t){return(new Date(t)).toString(e.StandBy.config.formats.date)}},convert:{absolute:function(e,t,n){var r=e.split("-"),i=(new Date(Date.parse(r[2]+"-"+r[1]+"-"+r[0]+" "+t))).getTime();return n?i/1e3:i}},calculate:{diff:function(e){return(new Date(e.end)).getTime()-(new Date(e.start)).getTime()}},getThisMonth:function(){return(new Date).toString("M")},getThisYear:function(){return(new Date).toString("yyyy")},getMonthTimeStamps:function(e){var t={};for(var n=0;n<12;n++){var r=(new Date(e,n)).moveToFirstDayOfMonth(),i=(new Date(e,n)).moveToLastDayOfMonth().addDays(1);t[n+1]={first:{day:r,timeStamp:r.getTime()},last:{day:i,timeStamp:i.getTime()},totalDays:Date.getDaysInMonth(e,n)}}return t},getWeekTimeStamps:function(e){var t=[],n={},r,i=(new Date(e,0)).moveToFirstDayOfMonth(),s=(new Date(e,0)).moveToFirstDayOfMonth().last().sunday().addWeeks(0),o=new Date(s);for(var u=0;u<54;u++)u==0?r=s.addWeeks(1):r=(new Date(t[u-1])).addWeeks(1),t.push(new Date(r));t.unshift(o);var a=new Date(t[54].addWeeks(1));for(var f=0;f<55;f++)n[f+1]={first:{day:t[f],timeStamp:(new Date(t[f])).getTime()},last:{day:t[f+1],timeStamp:(new Date(t[f+1])).getTime()}};return delete n[54],delete n[55],n},getDayTimeStamps:function(e){var t,n=[],r={},i=(new Date(e,0)).moveToFirstDayOfMonth();for(var s=0;s<366;s++)s==0?t=i:t=(new Date(n[s-1])).addDays(1),n.push(new Date(t));for(var o=0;o<366;o++)r[o+1]={first:{day:n[o],timeStamp:(new Date(n[o])).getTime()},last:{day:n[o+1],timeStamp:(new Date(n[o+1])).getTime()}};return r[366].timeStamp?r.total=366:(delete r[366],r.total=365),r},registerPeriods:function(){var e=t("app").get("periods"),n=t("app").get("periodsNext"),r=this.getThisYear(),i=Number(r)+1;t("app").save("periods",{months:this.getMonthTimeStamps(r),weeks:this.getWeekTimeStamps(r),days:this.getDayTimeStamps(r)}),t("app").save("periodsNext",{months:this.getMonthTimeStamps(i),weeks:this.getWeekTimeStamps(i),days:this.getDayTimeStamps(i)})},getPeriods:function(e){return t("app").get(e?"periodsNext":"periods")},translateToDutch:function(e){var t={Monday:"maandag",tuesday:"dinsdag",wednesday:"woensdag",thursday:"donderdag",friday:"vrijdag",saturday:"zaterdag",sunday:"zondag",january:"januari",february:"februari",march:"maart",april:"april",may:"mei",june:"juni",july:"juli",august:"augustus",september:"september",october:"oktober",november:"november",december:"december"};if(e)return _.each(t,function(t,n){e=e.replace(new RegExp(n,"gi"),t)}),e}}}])});