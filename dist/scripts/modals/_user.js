define(["services/services","config"],function(e,t){e.factory("UserLegacy",["$resource","$q","$location","Storage","$rootScope",function(e,n,r,i,s){var o=this,u=e(),a=e(t.host+"/login",{},{process:{method:"GET",params:{uuid:"",pass:""}}}),f=e(t.host+"/logout",{},{process:{method:"GET",params:{},isArray:!0}}),l=e(t.host+"/resources",{},{get:{method:"GET",params:{}}}),c=e(t.host+"/domain",{},{get:{method:"GET",params:{},isArray:!0}}),h=e(t.host+"/divisions",{},{get:{method:"GET",params:{},isArray:!0}}),p=e(t.host+"/states",{},{get:{method:"GET",params:{},isArray:!0}}),d=e(t.host+"/passwordReset",{},{password:{method:"GET",params:{uuid:"",path:""},isArray:!0}}),v=e(t.host+"/passwordReset",{},{reset:{method:"GET",params:{uuid:"",pass:"",key:""},isArray:!0}});return u.prototype.divisions=function(){var e=n.defer();return h.get({},function(t){e.resolve(t)},function(t){e.resolve(t)}),e.promise},u.prototype.states=function(){var e=n.defer();return p.get({},function(t){var n=[];angular.forEach(t,function(e){var t="";angular.forEach(e,function(e){t+=e}),n.push(t)}),e.resolve(n)},function(t){e.resolve(t)}),e.promise},u.prototype.password=function(e){var t=n.defer();return d.password({uuid:e.toLowerCase(),path:r.absUrl()},function(e){angular.equals(e,[])||angular.equals(e,[{}])?t.resolve("ok"):t.resolve(e)},function(e){t.resolve(e)}),t.promise},u.prototype.login=function(e,t){var r=n.defer();return a.process({uuid:e,pass:t},function(e){angular.equals(e,[])?r.reject("Something went wrong with login!"):r.resolve(e)},function(e){r.resolve(e)}),r.promise},u.prototype.changePass=function(e,t,r){var i=n.defer();return v.reset({uuid:e,pass:t,key:r},function(e){i.resolve(e)},function(e){i.resolve(e)}),i.promise},u.prototype.logout=function(){var e=n.defer();return f.process(null,function(t){e.resolve(t)},function(t){e.resolve({error:t})}),e.promise},u.prototype.resources=function(){var e=n.defer();return l.get(null,function(t){t.role=t.role||t.role==0?t.role:3,angular.equals(t,[])?e.reject("User has no resources!"):(i.add("resources",angular.toJson(t)),e.resolve(t))},function(t){e.resolve({error:t})}),e.promise},u.prototype.domain=function(){var e=n.defer();return c.get(null,function(t){var n=s.unite(t[0]);i.add("domain",angular.toJson(n)),e.resolve(n)},function(t){e.resolve({error:t})}),e.promise},new u}])});