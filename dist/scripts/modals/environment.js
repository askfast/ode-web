define(["services/services"],function(e){e.factory("Environment",["$rootScope","$resource","$q","Log","StandBy","Store",function(e,t,n,r,i,s){var o=t();return o.prototype.domain=function(){return i._("domain").then(function(t){var n=e.unite(t[0]);return s("environment").save("domain",n),e.StandBy.environment.domain=n,n})},o.prototype.domain_=function(){var t=n.defer();try{i._("domain").then(function(n){var r=e.unite(n[0]);s("environment").save("domain",r),e.StandBy.environment.domain=r,t.resolve(r)})}catch(o){r.error("Something went wrong with environment domain call:",o)}return t.promise},o.prototype.states=function(){var t=n.defer();try{i._("states").then(function(n){var r=[];_.each(n,function(t){r.push(e.unite(t))}),s("environment").save("states",r),e.StandBy.environment.states=r,_.each(r,function(t){e.StandBy.config.timeline.config.states[t]=e.StandBy.config.statesall[t]}),t.resolve(r)})}catch(o){r.error("Something went wrong with environment states call:",o)}return t.promise},o.prototype.divisions=function(){var t=n.defer();try{i._("divisions").then(function(n){s("environment").save("divisions",n),e.StandBy.environment.divisions=n,t.resolve(n)})}catch(o){r.error("Something went wrong with environment divisions call:",o)}return t.promise},o.prototype.setup=function(){var e=n.defer(),t=[o.prototype.domain(),o.prototype.states(),o.prototype.divisions()];try{n.all(t).then(function(t){e.resolve(t)})}catch(i){r.error("Something went wrong with setting up environment call:",i)}return e.promise},new o}])});