/**
 * AngularStrap - Twitter Bootstrap directives for AngularJS
 * @version v0.6.4 - 2013-02-03
 * @link http://mgcrea.github.com/angular-strap
 * @author Olivier Louvignes
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

angular.module("$strap.config",[]).value("$strap.config",{}),angular.module("$strap.filters",["$strap.config"]),angular.module("$strap.directives",["$strap.config"]),angular.module("$strap",["$strap.filters","$strap.directives","$strap.config"]),angular.module("$strap.directives").directive("bsAlert",["$parse","$timeout","$compile",function(e,t,n){return{restrict:"A",link:function(e,r,i){e.$watch(i.bsAlert,function(i,s){if(typeof i=="undefined"){typeof s!="undefined"&&r.remove();return}r.html((i.title?"<strong>"+i.title+"</strong>&nbsp;":"")+i.content||""),t(function(){n(r.contents())(e)});if(i.type||s.type)s.type&&r.removeClass("alert-"+s.type),i.type&&r.addClass("alert-"+i.type);i.close!==!1&&r.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>')},!0),!i.bsAlert&&i.close!=="0"&&r.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>'),r.addClass("alert").alert()}}}]),angular.module("$strap.directives").directive("bsButton",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",link:function(t,n,r,i){if(i){n.parent('[data-toggle="buttons-checkbox"], [data-toggle="buttons-radio"]').length||n.attr("data-toggle","button");var s=!!t.$eval(r.ngModel);s&&n.addClass("active"),t.$watch(r.ngModel,function(e,t){var r=!!e,i=!!t;r!==i?$.fn.button.Constructor.prototype.toggle.call(o):r&&!s&&n.addClass("active")})}n.hasClass("btn")||n.on("click.button.data-api",function(e){n.button("toggle")}),n.button();var o=n.data("button");o.toggle=function(){if(!i)return $.fn.button.Constructor.prototype.toggle.call(this);var r=n.parent('[data-toggle="buttons-radio"]');r.length?(n.siblings("[ng-model]").each(function(n,r){e($(r).attr("ng-model")).assign(t,!1)}),t.$digest(),i.$modelValue||(i.$setViewValue(!i.$modelValue),t.$digest())):t.$apply(function(){i.$setViewValue(!i.$modelValue)})}}}}]).directive("bsButtonsCheckbox",["$parse",function(e){return{restrict:"A",require:"?ngModel",compile:function(e,t,n){e.attr("data-toggle","buttons-checkbox").find("a, button").each(function(e,t){$(t).attr("bs-button","")})}}}]).directive("bsButtonsRadio",["$parse",function(e){return{restrict:"A",require:"?ngModel",compile:function(e,t,n){return e.attr("data-toggle","buttons-radio"),t.ngModel||e.find("a, button").each(function(e,t){$(t).attr("bs-button","")}),function(e,t,n,r){r&&(t.find("[value]").button().filter('[value="'+e.$eval(n.ngModel)+'"]').addClass("active"),t.on("click.button.data-api",function(t){e.$apply(function(){r.$setViewValue($(t.target).closest("button").attr("value"))})}),e.$watch(n.ngModel,function(r,i){if(r!==i){var s=t.find('[value="'+e.$eval(n.ngModel)+'"]');$.fn.button.Constructor.prototype.toggle.call(s.data("button"))}}))}}}}]),angular.module("$strap.directives").directive("bsButtonSelect",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",link:function(t,n,r,i){var s=e(r.bsButtonSelect),o=s.assign;i&&(n.text(t.$eval(r.ngModel)),t.$watch(r.ngModel,function(e,t){n.text(e)}));var u,a,f,l;n.on("click",function(){u=s(t),a=i?t.$eval(r.ngModel):n.text(),f=u.indexOf(a),l=f>u.length-2?u[0]:u[f+1],t.$apply(function(){n.text(l),i&&i.$setViewValue(l)})})}}}]),angular.module("$strap.directives").directive("bsDatepicker",["$timeout",function(e){var t="ontouchstart"in window&&!window.navigator.userAgent.match(/PhantomJS/i),n={"/":"[\\/]","-":"[-]",".":"[.]",dd:"(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))",d:"(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))",mm:"(?:[0]?[1-9]|[1][012])",m:"(?:[0]?[1-9]|[1][012])",yyyy:"(?:(?:[1]{1}[0-9]{1}[0-9]{1}[0-9]{1})|(?:[2]{1}[0-9]{3}))(?![[0-9]])",yy:"(?:(?:[0-9]{1}[0-9]{1}))(?![[0-9]])"};return{restrict:"A",require:"?ngModel",link:function(e,r,i,s){var o=function(e,t){t||(t={});var r=e,i=n;return angular.forEach(i,function(e,t){r=r.split(t).join(e)}),new RegExp("^"+r+"$",["i"])},u=t?"yyyy/mm/dd":o(i.dateFormat||"mm/dd/yyyy");s&&s.$parsers.unshift(function(e){return!e||u.test(e)?(s.$setValidity("date",!0),e):(s.$setValidity("date",!1),undefined)});var a=r.next('[data-toggle="datepicker"]');a.length&&a.on("click",function(){t?r.trigger("focus"):r.datepicker("show")});if(t&&r.prop("type")==="text")r.prop("type","date"),r.on("change",function(t){e.$apply(function(){s.$setViewValue(r.val())})});else{s&&r.on("changeDate",function(t){e.$apply(function(){s.$setViewValue(r.val())})});var f=r.closest(".popover");f&&f.on("hide",function(e){var t=r.data("datepicker");t&&(t.picker.remove(),r.data("datepicker",null))}),r.attr("data-toggle","datepicker"),r.datepicker({autoclose:!0,language:i.language||"en"})}}}}]),angular.module("$strap.directives").directive("bsDropdown",["$parse","$compile",function(e,t){var n=Array.prototype.slice,r='<ul class="dropdown-menu" role="menu" aria-labelledby="drop1"><li ng-repeat="item in items" ng-class="{divider: !!item.divider, \'dropdown-submenu\': !!item.submenu && item.submenu.length}"><a ng-hide="!!item.divider" tabindex="-1" ng-href="{{item.href}}" ng-click="{{item.click}}" target="{{item.target}}" ng-bind-html-unsafe="item.text"></a></li></ul>',i=function(e,n,i){var o,u,a;for(var f=0,l=e.length;f<l;f++)if(o=e[f].submenu)a=i.$new(),a.items=o,u=t(r)(a),u=u.appendTo(n.children("li:nth-child("+(f+1)+")")),s(o,u,a)},s=function(){var e=n.call(arguments);setTimeout(function(){i.apply(null,e)})};return{restrict:"EA",scope:!0,link:function(n,i,o){var u=e(o.bsDropdown);n.items=u(n);var a=t(r)(n);s(n.items,a,n),a.insertAfter(i),i.addClass("dropdown-toggle").attr("data-toggle","dropdown")}}}]),angular.module("$strap.directives").directive("bsModal",["$parse","$compile","$http","$timeout","$q","$templateCache",function(e,t,n,r,i,s){return{restrict:"A",scope:!0,link:function(o,u,a,f){var l=e(a.bsModal),c=l.assign,h=l(o);i.when(s.get(h)||n.get(h,{cache:!0})).then(function(e){angular.isObject(e)&&(e=e.data);var n=l(o).replace(".html","").replace(/\//g,"-").replace(/\./g,"-")+"-"+o.$id,i=$('<div class="modal hide" tabindex="-1"></div>').attr("id",n).attr("data-backdrop",a.backdrop||!0).attr("data-keyboard",a.keyboard||!0).addClass(a.modalClass?"fade "+a.modalClass:"fade").html(e);$("body").append(i),u.attr("href","#"+n).attr("data-toggle","modal"),r(function(){t(i)(o)}),o._modal=function(e){i.modal(e)},o.hide=function(){i.modal("hide")},o.show=function(){i.modal("show")},o.dismiss=o.hide})}}}]),angular.module("$strap.directives").directive("bsNavbar",["$location",function(e){return{restrict:"A",link:function(t,n,r,i){t.$watch(function(){return e.path()},function(e,t){n.find("li[data-match-route]").each(function(t,n){var r=angular.element(n),i=r.data("match-route"),s=new RegExp("^"+i+"$",["i"]);s.test(e)?r.addClass("active"):r.removeClass("active")})})}}}]),angular.module("$strap.directives").directive("bsPopover",["$parse","$compile","$http","$timeout","$q","$templateCache",function(e,t,n,r,i,s){return $("body").on("keyup",function(e){e.keyCode===27&&$(".popover.in").each(function(){var e=$(this);e.popover("hide")})}),{restrict:"A",scope:!0,link:function(o,u,a,f){var l=e(a.bsPopover),c=l.assign,h=l(o),p={};angular.isObject(h)&&(p=h),i.when(p.content||s.get(h)||n.get(h,{cache:!0})).then(function(e){angular.isObject(e)&&(e=e.data),!a.unique||u.on("show",function(e){$(".popover.in").each(function(){var e=$(this),t=e.data("popover");t&&!t.$element.is(u)&&e.popover("hide")})}),!a.hide||o.$watch(a.hide,function(e,t){!e||n.hide()}),u.popover(angular.extend({},p,{content:function(){return r(function(){var e=u.data("popover"),n=e.tip();t(n)(o),setTimeout(function(){e.refresh()})}),e},html:!0}));var n=u.data("popover");n.hasContent=function(){return this.getTitle()||e},n.refresh=function(){var e=this.tip(),t,n,r,i,s,o;s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height+10,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i-10,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r-10};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width+10}}e.offset(o)},n.show=function(){var e=$.Event("show");this.$element.trigger(e);if(e.isDefaultPrevented())return;var t=$.fn.popover.Constructor.prototype.show.apply(this,arguments);return this.$tip.data("popover",this),t},n.hide=function(){var e=$.Event("hide");this.$element.trigger(e);if(e.isDefaultPrevented())return;return $.fn.popover.Constructor.prototype.hide.apply(this,arguments)},o._popover=function(e){u.popover(e)},o.hide=function(){u.popover("hide")},o.show=function(){u.popover("show")},o.dismiss=o.hide})}}}]),angular.module("$strap.directives").directive("bsTimepicker",["$timeout",function(e){var t="((?:(?:[0-1][0-9])|(?:[2][0-3])|(?:[0-9])):(?:[0-5][0-9])(?::[0-5][0-9])?(?:\\s?(?:am|AM|pm|PM))?)";return{restrict:"A",require:"?ngModel",link:function(e,n,r,i){i&&n.on("change",function(t){e.$apply(function(){i.$setViewValue(n.val())})});var s=new RegExp("^"+t+"$",["i"]);i.$parsers.unshift(function(e){return!e||s.test(e)?(i.$setValidity("time",!0),e):(i.$setValidity("time",!1),undefined)});var o=n.closest(".popover");o&&o.on("hide",function(e){var t=n.data("timepicker");t&&(t.$widget.remove(),n.data("timepicker",null))}),n.attr("data-toggle","timepicker"),n.timepicker()}}}]),angular.module("$strap.directives").directive("bsTooltip",["$parse","$compile",function(e,t){return{restrict:"A",scope:!0,link:function(e,t,n,r){!n.unique||t.on("show",function(e){$(".tooltip.in").each(function(){var e=$(this),n=e.data("tooltip");n&&!n.$element.is(t)&&e.tooltip("hide")})}),t.tooltip({title:e.$eval(n.bsTooltip),html:!0});var i=t.data("tooltip");i.show=function(){var e=$.Event("show");this.$element.trigger(e);if(e.isDefaultPrevented())return;var t=$.fn.tooltip.Constructor.prototype.show.apply(this,arguments);return this.tip().data("tooltip",this),t},i.hide=function(){var e=$.Event("hide");this.$element.trigger(e);if(e.isDefaultPrevented())return;return $.fn.tooltip.Constructor.prototype.hide.apply(this,arguments)},e._tooltip=function(e){t.tooltip(e)},e.hide=function(){t.tooltip("hide")},e.show=function(){t.tooltip("show")},e.dismiss=e.hide}}}]),angular.module("$strap.directives").directive("bsTypeahead",["$parse",function(e){return{restrict:"A",require:"?ngModel",link:function(t,n,r,i){var s=e(r.bsTypeahead),o=s.assign,u=s(t);t.$watch(r.bsTypeahead,function(e,t){e!==t&&(u=e)}),n.attr("data-provide","typeahead"),n.typeahead({source:function(e){return angular.isFunction(u)?u.apply(null,arguments):u},minLength:r.minLength||1,items:r.items,updater:function(e){return i&&t.$apply(function(){i.$setViewValue(e)}),e}});var a=n.data("typeahead");a.lookup=function(e){var t;return this.query=this.$element.val()||"",this.query.length<this.options.minLength?this.shown?this.hide():this:(t=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source,t?this.process(t):this)},r.minLength==="0"&&setTimeout(function(){n.on("focus",function(){setTimeout(n.typeahead.bind(n,"lookup"),200)})})}}}]);