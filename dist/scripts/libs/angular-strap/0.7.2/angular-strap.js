/**
 * AngularStrap - Twitter Bootstrap directives for AngularJS
 * @version v0.7.2 - 2013-04-13
 * @link http://mgcrea.github.com/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

angular.module("$strap.config",[]).value("$strap.config",{}),angular.module("$strap.filters",["$strap.config"]),angular.module("$strap.directives",["$strap.config"]),angular.module("$strap",["$strap.filters","$strap.directives","$strap.config"]),angular.module("$strap.directives").directive("bsAlert",["$parse","$timeout","$compile",function(e,t,n){return{restrict:"A",link:function(r,i,s){var o=e(s.bsAlert),u=o.assign,a=o(r);s.bsAlert?r.$watch(s.bsAlert,function(e,t){a=e,i.html((e.title?"<strong>"+e.title+"</strong>&nbsp;":"")+e.content||""),!e.closed||i.hide(),n(i.contents())(r);if(e.type||t.type)t.type&&i.removeClass("alert-"+t.type),e.type&&i.addClass("alert-"+e.type);(angular.isUndefined(s.closeButton)||s.closeButton!=="0"&&s.closeButton!=="false")&&i.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>')},!0):(angular.isUndefined(s.closeButton)||s.closeButton!=="0"&&s.closeButton!=="false")&&i.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>'),i.addClass("alert").alert(),i.hasClass("fade")&&(i.removeClass("in"),setTimeout(function(){i.addClass("in")}));var f=s.ngRepeat&&s.ngRepeat.split(" in ").pop();i.on("close",function(e){var t;f?(e.preventDefault(),i.removeClass("in"),t=function(){i.trigger("closed"),r.$parent&&r.$parent.$apply(function(){var e=f.split("."),t=r.$parent;for(var n=0;n<e.length;++n)t&&(t=t[e[n]]);t&&t.splice(r.$index,1)})},$.support.transition&&i.hasClass("fade")?i.on($.support.transition.end,t):t()):a&&(e.preventDefault(),i.removeClass("in"),t=function(){i.trigger("closed"),r.$apply(function(){a.closed=!0})},$.support.transition&&i.hasClass("fade")?i.on($.support.transition.end,t):t())})}}}]),angular.module("$strap.directives").directive("bsButton",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){if(s){r.parent('[data-toggle="buttons-checkbox"], [data-toggle="buttons-radio"]').length||r.attr("data-toggle","button");var o=!!n.$eval(i.ngModel);o&&r.addClass("active"),n.$watch(i.ngModel,function(e,t){var n=!!e,i=!!t;n!==i?$.fn.button.Constructor.prototype.toggle.call(u):n&&!o&&r.addClass("active")})}r.hasClass("btn")||r.on("click.button.data-api",function(e){r.button("toggle")}),r.button();var u=r.data("button");u.toggle=function(){if(!s)return $.fn.button.Constructor.prototype.toggle.call(this);var t=r.parent('[data-toggle="buttons-radio"]');t.length?(r.siblings("[ng-model]").each(function(t,r){e($(r).attr("ng-model")).assign(n,!1)}),n.$digest(),s.$modelValue||(s.$setViewValue(!s.$modelValue),n.$digest())):n.$apply(function(){s.$setViewValue(!s.$modelValue)})}}}}]).directive("bsButtonsCheckbox",["$parse",function(e){return{restrict:"A",require:"?ngModel",compile:function(t,n,r){t.attr("data-toggle","buttons-checkbox").find("a, button").each(function(e,t){$(t).attr("bs-button","")})}}}]).directive("bsButtonsRadio",["$timeout",function(e){return{restrict:"A",require:"?ngModel",compile:function(n,r,i){return n.attr("data-toggle","buttons-radio"),r.ngModel||n.find("a, button").each(function(e,t){$(t).attr("bs-button","")}),function(n,r,i,s){s&&(e(function(){r.find("[value]").button().filter('[value="'+s.$viewValue+'"]').addClass("active")}),r.on("click.button.data-api",function(e){n.$apply(function(){s.$setViewValue($(e.target).closest("button").attr("value"))})}),n.$watch(i.ngModel,function(e,t){if(e!==t){var s=r.find('[value="'+n.$eval(i.ngModel)+'"]');s.length&&s.button("toggle")}}))}}}}]),angular.module("$strap.directives").directive("bsButtonSelect",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){var o=e(i.bsButtonSelect),u=o.assign;s&&(r.text(n.$eval(i.ngModel)),n.$watch(i.ngModel,function(e,t){r.text(e)}));var a,f,l,c;r.bind("click",function(e){a=o(n),f=s?n.$eval(i.ngModel):r.text(),l=a.indexOf(f),c=l>a.length-2?a[0]:a[l+1],console.warn(a,c),n.$apply(function(){r.text(c),s&&s.$setViewValue(c)})})}}}]),angular.module("$strap.directives").directive("bsDatepicker",["$timeout","$strap.config",function(e,t){var n=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1,r=function(t){return t=t||"en",{"/":"[\\/]","-":"[-]",".":"[.]"," ":"[\\s]",dd:"(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))",d:"(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))",mm:"(?:[0]?[1-9]|[1][012])",m:"(?:[0]?[1-9]|[1][012])",DD:"(?:"+$.fn.datepicker.dates[t].days.join("|")+")",D:"(?:"+$.fn.datepicker.dates[t].daysShort.join("|")+")",MM:"(?:"+$.fn.datepicker.dates[t].months.join("|")+")",M:"(?:"+$.fn.datepicker.dates[t].monthsShort.join("|")+")",yyyy:"(?:(?:[1]{1}[0-9]{1}[0-9]{1}[0-9]{1})|(?:[2]{1}[0-9]{3}))(?![[0-9]])",yy:"(?:(?:[0-9]{1}[0-9]{1}))(?![[0-9]])"}},i=function(t,n){var i=t,s=r(n),o;return o=0,angular.forEach(s,function(e,t){i=i.split(t).join("${"+o+"}"),o++}),o=0,angular.forEach(s,function(e,t){i=i.split("${"+o+"}").join(e),o++}),new RegExp("^"+i+"$",["i"])};return{restrict:"A",require:"?ngModel",link:function(r,s,o,u){var a=t.datepicker||{},f=o.language||a.language||"en",l=o.dateType||a.type||"date",c=o.dateFormat||a.format||$.fn.datepicker.dates[f]&&$.fn.datepicker.dates[f].format||"yyyy-mm-dd",h=n?i("yyyy-mm-dd",f):i(c,f);u&&(u.$parsers.unshift(function(e){return e?l==="date"&&angular.isDate(e)?(u.$setValidity("date",!0),e):angular.isString(e)&&h.test(e)?(u.$setValidity("date",!0),n?new Date(e):l==="string"?e:$.fn.datepicker.DPGlobal.parseDate(e,$.fn.datepicker.DPGlobal.parseFormat(c),f)):(u.$setValidity("date",!1),undefined):(u.$setValidity("date",!0),null)}),u.$render=function(){return u.$modelValue&&s.datepicker("update",u.$modelValue)}),n?s.prop("type","date").css("-webkit-appearance","textfield"):(u&&s.on("changeDate",function(e){r.$apply(function(){u.$setViewValue(l==="string"?s.val():e.date)})}),s.attr("data-toggle","datepicker"),s.datepicker({autoclose:!0,format:c,language:f,forceParse:o.forceParse||!1}),r.$on("$destroy",function(){console.warn("$destroy");var e=s.data("datepicker");e&&(e.picker.remove(),s.data("datepicker",null))}));var p=s.siblings('[data-toggle="datepicker"]');p.length&&p.on("click",function(){s.trigger("focus")})}}}]),angular.module("$strap.directives").directive("bsDropdown",["$parse","$compile","$timeout",function(e,t,n){var r=function(e,t){return t||(t=['<ul class="dropdown-menu" role="menu" aria-labelledby="drop1">',"</ul>"]),angular.forEach(e,function(e,n){if(e.divider)return t.splice(n+1,0,'<li class="divider"></li>');var i="<li"+(e.submenu&&e.submenu.length?' class="dropdown-submenu"':"")+">"+'<a tabindex="-1" ng-href="'+(e.href||"")+'"'+(e.click?'" ng-click="'+e.click+'"':"")+(e.target?'" target="'+e.target+'"':"")+">"+(e.text||"")+"</a>";e.submenu&&e.submenu.length&&(i+=r(e.submenu).join("\n")),i+="</li>",t.splice(n+1,0,i)}),t};return{restrict:"EA",scope:!0,link:function(s,o,u){var a=e(u.bsDropdown),f=a(s);n(function(){!angular.isArray(f);var e=angular.element(r(f).join(""));e.insertAfter(o),t(o.next("ul.dropdown-menu"))(s)}),o.addClass("dropdown-toggle").attr("data-toggle","dropdown")}}}]),angular.module("$strap.directives").factory("$modal",["$rootScope","$compile","$http","$timeout","$q","$templateCache",function(e,t,n,r,i,s){var o=function(u){function a(o){o||(o={});var u=o.scope||e.$new(),a=o.template;return i.when(s.get(a)||n.get(a,{cache:!0}).then(function(e){return e.data})).then(function(n){var i=a.replace(".html","").replace(/[\/|\.|:]/g,"-")+"-"+u.$id,s=$('<div class="modal hide" tabindex="-1"></div>').attr("id",i).addClass("fade").html(n);return o.modalClass&&s.addClass(o.modalClass),$("body").append(s),r(function(){t(s)(u)}),u.$modal=function(e){s.modal(e)},u.hide=function(){s.modal("hide")},u.show=function(){s.modal("show")},u.dismiss=u.hide,angular.forEach(["show","shown","hide","hidden"],function(e){s.on(e,function(t){u.$emit("modal-"+e,t)})}),s.on("shown",function(e){$("input[autofocus]",s).first().trigger("focus")}),o.show&&s.modal("show"),s})}return new a(u)};return o}]).directive("bsModal",["$q","$modal",function(e,t){return{restrict:"A",scope:!0,link:function(r,i,s,o){var u={template:r.$eval(s.bsModal),scope:r,modalClass:s.modalClass||"",backdrop:s.backdrop*1||!0,keyboard:s.keyboard*1||!0,show:s.show*1||!1};e.when(t(u)).then(function(t){i.attr("data-target","#"+t.attr("id")).attr("data-toggle","modal")})}}}]),angular.module("$strap.directives").directive("bsNavbar",["$location",function(e){return{restrict:"A",link:function(n,r,i,s){n.$watch(function(){return e.path()},function(e,t){$("li[data-match-route]",r).each(function(t,n){var r=angular.element(n),i=r.attr("data-match-route"),s=new RegExp("^"+i+"$",["i"]);s.test(e)?r.addClass("active"):r.removeClass("active")})})}}}]),angular.module("$strap.directives").directive("bsPopover",["$parse","$compile","$http","$timeout","$q","$templateCache",function(e,t,n,r,i,s){return $("body").on("keyup",function(e){e.keyCode===27&&$(".popover.in").each(function(){$(this).popover("hide")})}),{restrict:"A",scope:!0,link:function(o,u,a,f){var l=e(a.bsPopover),c=l.assign,h=l(o),p={};angular.isObject(h)&&(p=h),i.when(p.content||s.get(h)||n.get(h,{cache:!0})).then(function(n){angular.isObject(n)&&(n=n.data),!a.unique||u.on("show",function(e){$(".popover.in").each(function(){var e=$(this),t=e.data("popover");t&&!t.$element.is(u)&&e.popover("hide")})}),!a.hide||o.$watch(a.hide,function(e,t){e?r.hide():e!==t&&r.show()}),u.popover(angular.extend({},p,{content:n,html:!0}));var r=u.data("popover");r.hasContent=function(){return this.getTitle()||n},r.getPosition=function(){var e=$.fn.popover.Constructor.prototype.getPosition.apply(this,arguments);return t(this.$tip)(o),o.$digest(),this.$tip.data("popover",this),e},o._popover=function(e){u.popover(e)},o.hide=function(){u.popover("hide")},o.show=function(){u.popover("show")},o.dismiss=o.hide})}}}]),angular.module("$strap.directives").directive("bsSelect",["$timeout",function(e){var t=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w\d]*)|(?:\(\s*([\$\w][\$\w\d]*)\s*,\s*([\$\w][\$\w\d]*)\s*\)))\s+in\s+(.*)$/;return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){var o=n.$eval(i.bsSelect)||{};e(function(){r.selectpicker(o),r.next().removeClass("ng-scope")}),s&&n.$watch(i.ngModel,function(e,t){e!==t&&r.selectpicker("refresh")})}}}]),angular.module("$strap.directives").directive("bsTabs",["$parse","$compile","$timeout",function(e,t,n){var r='<div class="tabs"><ul class="nav nav-tabs"><li ng-repeat="pane in panes" ng-class="{active:pane.active}"><a data-target="#{{pane.id}}" data-index="{{$index}}" data-toggle="tab">{{pane.title}}</a></li></ul><div class="tab-content" ng-transclude></div>';return{restrict:"A",require:"?ngModel",priority:0,scope:!0,template:r,replace:!0,transclude:!0,compile:function(r,i,s){return function(r,i,s,o){var u=e(s.bsTabs),a=u.assign,f=u(r);r.panes=[];var l=i.find("ul.nav-tabs"),c=i.find("div.tab-content"),h=0,p,d,v;n(function(){c.find("[data-title], [data-tab]").each(function(e){var t=angular.element(this);p="tab-"+r.$id+"-"+e,d=t.data("title")||t.data("tab"),v=!v&&t.hasClass("active"),t.attr("id",p).addClass("tab-pane"),s.fade&&t.addClass("fade"),r.panes.push({id:p,title:d,content:this.innerHTML,active:v})}),r.panes.length&&!v&&(c.find(".tab-pane:first").addClass("active"+(s.fade?" in":"")),r.panes[0].active=!0)}),o&&(i.on("show",function(e){var t=$(e.target);r.$apply(function(){o.$setViewValue(t.data("index"))})}),r.$watch(s.ngModel,function(e,t){if(angular.isUndefined(e))return;h=e,setTimeout(function(){var t=l.find("li:eq("+e*1+")");t.hasClass("active")||t.children("a").tab("show")})}))}}}}]),angular.module("$strap.directives").directive("bsTimepicker",["$timeout",function(e){var t="((?:(?:[0-1][0-9])|(?:[2][0-3])|(?:[0-9])):(?:[0-5][0-9])(?::[0-5][0-9])?(?:\\s?(?:am|AM|pm|PM))?)";return{restrict:"A",require:"?ngModel",link:function(r,i,s,o){o&&i.on("changeTime.timepicker",function(t){e(function(){o.$setViewValue(i.val())})});var u=new RegExp("^"+t+"$",["i"]);o.$parsers.unshift(function(e){if(!e||u.test(e))return o.$setValidity("time",!0),e;o.$setValidity("time",!1);return}),i.attr("data-toggle","timepicker"),i.parent().addClass("bootstrap-timepicker"),i.timepicker();var a=i.data("timepicker"),f=i.siblings('[data-toggle="timepicker"]');f.length&&f.on("click",$.proxy(a.showWidget,a))}}}]),angular.module("$strap.directives").directive("bsTooltip",["$parse","$compile",function(e,t){return{restrict:"A",scope:!0,link:function(n,r,i,s){var o=e(i.bsTooltip),u=o.assign,a=o(n);n.$watch(i.bsTooltip,function(e,t){e!==t&&(a=e)}),!i.unique||r.on("show",function(e){$(".tooltip.in").each(function(){var e=$(this),t=e.data("tooltip");t&&!t.$element.is(r)&&e.tooltip("hide")})}),r.tooltip({title:function(){return angular.isFunction(a)?a.apply(null,arguments):a},html:!0});var f=r.data("tooltip");f.show=function(){var e=$.fn.tooltip.Constructor.prototype.show.apply(this,arguments);return this.tip().data("tooltip",this),e},n._tooltip=function(e){r.tooltip(e)},n.hide=function(){r.tooltip("hide")},n.show=function(){r.tooltip("show")},n.dismiss=n.hide}}}]),angular.module("$strap.directives").directive("bsTypeahead",["$parse",function(e){return{restrict:"A",require:"?ngModel",link:function(n,r,i,s){var o=e(i.bsTypeahead),u=o.assign,a=o(n);n.$watch(i.bsTypeahead,function(e,t){e!==t&&(a=e)}),r.attr("data-provide","typeahead"),r.typeahead({source:function(e){return angular.isFunction(a)?a.apply(null,arguments):a},minLength:i.minLength||1,items:i.items,updater:function(e){return s&&n.$apply(function(){s.$setViewValue(e)}),n.$emit("typeahead-updated",e),e}});var f=r.data("typeahead");f.lookup=function(e){var t;return this.query=this.$element.val()||"",this.query.length<this.options.minLength?this.shown?this.hide():this:(t=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source,t?this.process(t):this)},i.minLength==="0"&&setTimeout(function(){r.on("focus",function(){r.val().length===0&&setTimeout(r.typeahead.bind(r,"lookup"),200)})})}}}]);