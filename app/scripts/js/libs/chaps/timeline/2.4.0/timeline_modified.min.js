/*! timeline 2.4.0 modified */
"undefined"==typeof links&&(links={}),"undefined"==typeof google&&(google=void 0),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;this.length>t;t++)if(this[t]==e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var i=0,n=this.length;n>i;++i)e.call(t||this,this[i],i,this)}),links.Timeline=function(e){this.dom={},this.conversion={},this.eventParams={},this.groups=[],this.groupIndexes={},this.items=[],this.visibleItems=[],this.clusterFactory=new links.Timeline.ClusterFactory(this),this.currentClusters=[],this.selection=void 0,this.listeners={},this.size={actualHeight:0,axis:{characterMajorHeight:0,characterMajorWidth:0,characterMinorHeight:0,characterMinorWidth:0,height:0,labelMajorTop:0,labelMinorTop:0,line:0,lineMajorWidth:0,lineMinorHeight:0,lineMinorTop:0,lineMinorWidth:0,top:0},contentHeight:0,contentLeft:0,contentWidth:0,frameHeight:0,frameWidth:0,groupsLeft:0,groupsWidth:0,items:{top:0}},this.dom.container=e,this.options={width:"100%",height:"auto",minHeight:0,autoHeight:!0,eventMargin:10,eventMarginAxis:20,dragAreaWidth:10,min:void 0,max:void 0,intervalMin:10,intervalMax:31536e10,moveable:!0,zoomable:!0,selectable:!0,editable:!1,snapEvents:!0,groupChangeable:!0,showCurrentTime:!0,showCustomTime:!1,showMajorLabels:!0,showMinorLabels:!0,showNavigation:!1,showButtonNew:!1,groupsOnRight:!1,axisOnTop:!1,stackEvents:!0,animate:!0,animateZoom:!0,cluster:!1,style:"box"},this.clientTimeOffset=0;for(var t=this.dom;t.container.hasChildNodes();)t.container.removeChild(t.container.firstChild);this.step=new links.Timeline.StepDate,this.data=[],this.firstDraw=!0,this.setVisibleChartRange(void 0,void 0,!1),this.render(),this.trigger("ready")},links.Timeline.prototype.draw=function(e,t){this.setOptions(t),this.setData(e),t&&(t.start||t.end)?this.setVisibleChartRange(t.start,t.end):this.firstDraw&&this.setVisibleChartRangeAuto(),this.firstDraw=!1},links.Timeline.prototype.setOptions=function(e){if(e){for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);void 0!=e.showButtonAdd&&(this.options.showButtonNew=e.showButtonAdd,console.log("WARNING: Option showButtonAdd is deprecated. Use showButtonNew instead")),e.scale&&e.step&&this.step.setScale(e.scale,e.step)}this.options.autoHeight="auto"===this.options.height},links.Timeline.mapColumnIds=function(e){for(var t={},i=e.getNumberOfColumns(),n=!0,s=0;i>s;s++){var o=e.getColumnId(s)||e.getColumnLabel(s);("start"==o||"end"==o||"content"==o||"group"==o||"className"==o||"editable"==o)&&(t[o]=s,n=!1)}return n&&(t.start=0,t.end=1,t.content=2),t},links.Timeline.prototype.setData=function(e){this.unselectItem(),e||(e=[]),this.stackCancelAnimation(),this.clearItems(),this.data=e;var t=this.items;if(this.deleteGroups(),google&&google.visualization&&e instanceof google.visualization.DataTable)for(var i=links.Timeline.mapColumnIds(e),n=0,s=e.getNumberOfRows();s>n;n++)t.push(this.createItem({start:void 0!=i.start?e.getValue(n,i.start):void 0,end:void 0!=i.end?e.getValue(n,i.end):void 0,content:void 0!=i.content?e.getValue(n,i.content):void 0,group:void 0!=i.group?e.getValue(n,i.group):void 0,className:void 0!=i.className?e.getValue(n,i.className):void 0,editable:void 0!=i.editable?e.getValue(n,i.editable):void 0}));else{if(!links.Timeline.isArray(e))throw"Unknown data type. DataTable or Array expected.";for(var n=0,s=e.length;s>n;n++){var o=e[n],a=this.createItem(o);t.push(a)}}this.options.cluster&&this.clusterFactory.setData(this.items),this.render({animate:!1})},links.Timeline.prototype.getData=function(){return this.data},links.Timeline.prototype.updateData=function(e,t){var i=this.data;if(google&&google.visualization&&i instanceof google.visualization.DataTable){var n=e+1-i.getNumberOfRows();n>0&&i.addRows(n);var s=links.Timeline.mapColumnIds(i);t.start&&i.setValue(e,s.start,t.start),t.end&&i.setValue(e,s.end,t.end),t.content&&i.setValue(e,s.content,t.content),t.group&&void 0!=s.group&&i.setValue(e,s.group,t.group),t.className&&void 0!=s.className&&i.setValue(e,s.className,t.className),t.editable&&void 0!=s.editable&&i.setValue(e,s.editable,t.editable)}else{if(!links.Timeline.isArray(i))throw"Cannot update data, unknown type of data";var o=i[e];void 0==o&&(o={},i[e]=o),t.start&&(o.start=t.start),t.end&&(o.end=t.end),t.content&&(o.content=t.content),t.group&&(o.group=t.group),t.className&&(o.className=t.className),void 0!=t.editable&&(o.editable=t.editable)}},links.Timeline.prototype.getItemIndex=function(e){for(var t=e,i=this.dom,n=i.items.frame,s=this.items,o=void 0;t.parentNode&&t.parentNode!==n;)t=t.parentNode;if(t.parentNode===n)for(var a=0,r=s.length;r>a;a++)if(s[a].dom===t){o=a;break}return o},links.Timeline.prototype.setSize=function(e,t){e&&(this.options.width=e,this.dom.frame.style.width=e),t&&(this.options.height=t,this.options.autoHeight="auto"===this.options.height,"auto"!==t&&(this.dom.frame.style.height=t)),this.render({animate:!1})},links.Timeline.prototype.setVisibleChartRange=function(e,t,i){var n={};e&&t||(n=this.getDataRange(!0)),e||(t?n.min&&n.min.valueOf()<t.valueOf()?e=n.min:(e=new Date(t),e.setDate(e.getDate()-7)):(e=new Date,e.setDate(e.getDate()-3))),t||(n.max?t=n.max:(t=new Date(e),t.setDate(t.getDate()+7))),t.valueOf()<=e.valueOf()&&(t=new Date(e),t.setDate(t.getDate()+7));var s=this.options.min?this.options.min.valueOf():void 0;void 0!=s&&s>e.valueOf()&&(e=new Date(s));var o=this.options.max?this.options.max.valueOf():void 0;void 0!=o&&t.valueOf()>o&&(t=new Date(o)),this.applyRange(e,t),void 0==i||1==i?this.render({animate:!1}):this.recalcConversion()},links.Timeline.prototype.setVisibleChartRangeAuto=function(){var e=this.getDataRange(!0);this.setVisibleChartRange(e.min,e.max)},links.Timeline.prototype.setVisibleChartRangeNow=function(){var e=new Date,t=this.end.getTime()-this.start.getTime(),i=new Date(e.getTime()-t/2),n=new Date(i.getTime()+t);this.setVisibleChartRange(i,n)},links.Timeline.prototype.getVisibleChartRange=function(){return{start:new Date(this.start),end:new Date(this.end)}},links.Timeline.prototype.getDataRange=function(e){var t=this.items,i=void 0,n=void 0;if(t)for(var s=0,o=t.length;o>s;s++){var a=t[s],r=a.start?a.start.valueOf():void 0,l=a.end?a.end.valueOf():r;i=void 0!=i&&void 0!=r?Math.min(i,r):r,n=void 0!=n&&void 0!=l?Math.max(n,l):l}if(i&&n&&e){var h=n.valueOf()-i.valueOf();i=new Date(i.valueOf()-.05*h),n=new Date(n.valueOf()+.05*h)}return{min:i?new Date(i):void 0,max:n?new Date(n):void 0}},links.Timeline.prototype.render=function(e){this.reflowFrame(),this.reflowAxis(),this.reflowGroups(),this.reflowItems();var t=this.options.animate;e&&void 0!=e.animate&&(t=e.animate),this.recalcConversion(),this.filterItems(),this.stackItems(t),this.recalcItems();var i=this.repaint();if(i){var n=e?e.renderTimesLeft:void 0;void 0==n&&(n=5),n>0&&this.render({animate:e?e.animate:void 0,renderTimesLeft:n-1})}},links.Timeline.prototype.repaint=function(){var e=this.repaintFrame(),t=this.repaintAxis(),i=this.repaintGroups(),n=this.repaintItems();return this.repaintCurrentTime(),this.repaintCustomTime(),e||t||i||n},links.Timeline.prototype.reflowFrame=function(){var e=this.dom,t=(this.options,this.size),i=!1,n=e.frame?e.frame.offsetWidth:0,s=e.frame?e.frame.clientHeight:0;return i=i||t.frameWidth!==n,i=i||t.frameHeight!==s,t.frameWidth=n,t.frameHeight=s,i},links.Timeline.prototype.repaintFrame=function(){var e=!1,t=this.dom,i=this.options,n=this.size;t.frame||(t.frame=document.createElement("DIV"),t.frame.className="timeline-frame",t.frame.style.position="relative",t.frame.style.overflow="hidden",t.container.appendChild(t.frame),e=!0);var s=i.autoHeight?n.actualHeight+"px":i.height||"100%",o=i.width||"100%";if(e=e||t.frame.style.height!=s,e=e||t.frame.style.width!=o,t.frame.style.height=s,t.frame.style.width=o,!t.content){t.content=document.createElement("DIV"),t.content.style.position="relative",t.content.style.overflow="hidden",t.frame.appendChild(t.content);var a=document.createElement("DIV");a.style.position="absolute",a.style.left="0px",a.style.top="0px",a.style.height="100%",a.style.width="0px",t.content.appendChild(a),t.contentTimelines=a;var r=this.eventParams,l=this;r.onMouseDown||(r.onMouseDown=function(e){l.onMouseDown(e)},links.Timeline.addEventListener(t.content,"mousedown",r.onMouseDown)),r.onTouchStart||(r.onTouchStart=function(e){l.onTouchStart(e)},links.Timeline.addEventListener(t.content,"touchstart",r.onTouchStart)),r.onMouseWheel||(r.onMouseWheel=function(e){l.onMouseWheel(e)},links.Timeline.addEventListener(t.content,"mousewheel",r.onMouseWheel)),r.onDblClick||(r.onDblClick=function(e){l.onDblClick(e)},links.Timeline.addEventListener(t.content,"dblclick",r.onDblClick)),e=!0}return t.content.style.left=n.contentLeft+"px",t.content.style.top="0px",t.content.style.width=n.contentWidth+"px",t.content.style.height=n.frameHeight+"px",this.repaintNavigation(),e},links.Timeline.prototype.reflowAxis=function(){var e=!1,t=this.dom,i=this.options,n=this.size,s=t.axis,o=s&&s.characterMinor?s.characterMinor.clientWidth:0,a=s&&s.characterMinor?s.characterMinor.clientHeight:0,r=s&&s.characterMajor?s.characterMajor.clientWidth:0,l=s&&s.characterMajor?s.characterMajor.clientHeight:0,h=(i.showMinorLabels?a:0)+(i.showMajorLabels?l:0),m=i.axisOnTop?0:n.frameHeight-h,p=i.axisOnTop?h:m;e=e||n.axis.top!==m,e=e||n.axis.line!==p,e=e||n.axis.height!==h,n.axis.top=m,n.axis.line=p,n.axis.height=h,n.axis.labelMajorTop=i.axisOnTop?0:p+(i.showMinorLabels?a:0),n.axis.labelMinorTop=i.axisOnTop?i.showMajorLabels?l:0:p,n.axis.lineMinorTop=i.axisOnTop?n.axis.labelMinorTop:0,n.axis.lineMinorHeight=i.showMajorLabels?n.frameHeight-l:n.frameHeight,n.axis.lineMinorWidth=s&&s.minorLines&&s.minorLines.length?s.minorLines[0].offsetWidth:1,n.axis.lineMajorWidth=s&&s.majorLines&&s.majorLines.length?s.majorLines[0].offsetWidth:1,e=e||n.axis.characterMinorWidth!==o,e=e||n.axis.characterMinorHeight!==a,e=e||n.axis.characterMajorWidth!==r,e=e||n.axis.characterMajorHeight!==l,n.axis.characterMinorWidth=o,n.axis.characterMinorHeight=a,n.axis.characterMajorWidth=r,n.axis.characterMajorHeight=l;var c=Math.max(n.frameHeight-h,0);return n.contentLeft=i.groupsOnRight?0:n.groupsWidth,n.contentWidth=Math.max(n.frameWidth-n.groupsWidth,0),n.contentHeight=c,e},links.Timeline.prototype.repaintAxis=function(){var e=!1,t=this.dom,i=this.options,n=this.size,s=this.step,o=t.axis;o||(o={},t.axis=o),n.axis.properties||(n.axis.properties={}),o.minorTexts||(o.minorTexts=[]),o.minorLines||(o.minorLines=[]),o.majorTexts||(o.majorTexts=[]),o.majorLines||(o.majorLines=[]),o.frame||(o.frame=document.createElement("DIV"),o.frame.style.position="absolute",o.frame.style.left="0px",o.frame.style.top="0px",t.content.appendChild(o.frame)),t.content.removeChild(o.frame),o.frame.style.width=n.contentWidth+"px",o.frame.style.height=n.axis.height+"px";var a=this.screenToTime(0),r=this.screenToTime(n.contentWidth);n.axis.characterMinorWidth&&(this.minimumStep=this.screenToTime(6*n.axis.characterMinorWidth).valueOf()-this.screenToTime(0).valueOf(),s.setRange(a,r,this.minimumStep));var l=this.repaintAxisCharacters();e=e||l,this.repaintAxisStartOverwriting(),s.start();for(var h=void 0,m=0;!s.end()&&1e3>m;){m++;var p=s.getCurrent(),c=this.timeToScreen(p),d=s.isMajor();i.showMinorLabels&&this.repaintAxisMinorText(c,s.getLabelMinor()),d&&i.showMajorLabels?(c>0&&(void 0===h&&(h=c),this.repaintAxisMajorText(c,s.getLabelMajor())),this.repaintAxisMajorLine(c)):this.repaintAxisMinorLine(c),s.next()}if(i.showMajorLabels){var u=this.screenToTime(0),g=this.step.getLabelMajor(u),f=g.length*n.axis.characterMajorWidth+10;(void 0===h||h>f)&&this.repaintAxisMajorText(0,g,u)}return this.repaintAxisEndOverwriting(),this.repaintAxisHorizontal(),t.content.insertBefore(o.frame,t.content.firstChild),e},links.Timeline.prototype.repaintAxisCharacters=function(){var e,t=!1,i=this.dom,n=i.axis;if(!n.characterMinor){e=document.createTextNode("0");var s=document.createElement("DIV");s.className="timeline-axis-text timeline-axis-text-minor",s.appendChild(e),s.style.position="absolute",s.style.visibility="hidden",s.style.paddingLeft="0px",s.style.paddingRight="0px",n.frame.appendChild(s),n.characterMinor=s,t=!0}if(!n.characterMajor){e=document.createTextNode("0");var o=document.createElement("DIV");o.className="timeline-axis-text timeline-axis-text-major",o.appendChild(e),o.style.position="absolute",o.style.visibility="hidden",o.style.paddingLeft="0px",o.style.paddingRight="0px",n.frame.appendChild(o),n.characterMajor=o,t=!0}return t},links.Timeline.prototype.repaintAxisStartOverwriting=function(){var e=this.size.axis.properties;e.minorTextNum=0,e.minorLineNum=0,e.majorTextNum=0,e.majorLineNum=0},links.Timeline.prototype.repaintAxisEndOverwriting=function(){var e,t=this.dom,i=this.size.axis.properties,n=this.dom.axis.frame,s=t.axis.minorTexts;for(e=i.minorTextNum;s.length>e;){var o=s[e];n.removeChild(o),s.splice(e,1)}var a=t.axis.minorLines;for(e=i.minorLineNum;a.length>e;){var r=a[e];n.removeChild(r),a.splice(e,1)}var l=t.axis.majorTexts;for(e=i.majorTextNum;l.length>e;){var h=l[e];n.removeChild(h),l.splice(e,1)}var m=t.axis.majorLines;for(e=i.majorLineNum;m.length>e;){var p=m[e];n.removeChild(p),m.splice(e,1)}},links.Timeline.prototype.repaintAxisHorizontal=function(){var e=this.dom.axis,t=this.size,i=this.options,n=i.showMinorLabels||i.showMajorLabels;if(n){if(!e.backgroundLine){var s=document.createElement("DIV");s.className="timeline-axis",s.style.position="absolute",s.style.left="0px",s.style.width="100%",s.style.border="none",e.frame.insertBefore(s,e.frame.firstChild),e.backgroundLine=s}e.backgroundLine&&(e.backgroundLine.style.top=t.axis.top+"px",e.backgroundLine.style.height=t.axis.height+"px")}else e.backgroundLine&&(e.frame.removeChild(e.backgroundLine),delete e.backgroundLine);if(n){if(e.line){var o=e.frame.removeChild(e.line);e.frame.appendChild(o)}else{var o=document.createElement("DIV");o.className="timeline-axis",o.style.position="absolute",o.style.left="0px",o.style.width="100%",o.style.height="0px",e.frame.appendChild(o),e.line=o}e.line.style.top=t.axis.line+"px"}else e.line&&e.line.parentElement&&(e.frame.removeChild(e.line),delete e.line)},links.Timeline.prototype.repaintAxisMinorText=function(e,t){var i,n=this.size,s=this.dom,o=n.axis.properties,a=s.axis.frame,r=s.axis.minorTexts,l=o.minorTextNum;if(r.length>l)i=r[l];else{var h=document.createTextNode("");i=document.createElement("DIV"),i.appendChild(h),i.className="timeline-axis-text timeline-axis-text-minor",i.style.position="absolute",a.appendChild(i),r.push(i)}i.childNodes[0].nodeValue=t,i.style.left=e+"px",i.style.top=n.axis.labelMinorTop+"px",o.minorTextNum++},links.Timeline.prototype.repaintAxisMinorLine=function(e){var t,i=this.size.axis,n=this.dom,s=i.properties,o=n.axis.frame,a=n.axis.minorLines,r=s.minorLineNum;a.length>r?t=a[r]:(t=document.createElement("DIV"),t.className="timeline-axis-grid timeline-axis-grid-minor",t.style.position="absolute",t.style.width="0px",o.appendChild(t),a.push(t)),t.style.top=i.lineMinorTop+"px",t.style.height=i.lineMinorHeight+"px",t.style.left=e-i.lineMinorWidth/2+"px",s.minorLineNum++},links.Timeline.prototype.repaintAxisMajorText=function(e,t){var i,n=this.size,s=n.axis.properties,o=this.dom.axis.frame,a=this.dom.axis.majorTexts,r=s.majorTextNum;if(a.length>r)i=a[r];else{var l=document.createTextNode(t);i=document.createElement("DIV"),i.className="timeline-axis-text timeline-axis-text-major",i.appendChild(l),i.style.position="absolute",i.style.top="0px",o.appendChild(i),a.push(i)}i.childNodes[0].nodeValue=t,i.style.top=n.axis.labelMajorTop+"px",i.style.left=e+"px",s.majorTextNum++},links.Timeline.prototype.repaintAxisMajorLine=function(e){var t,i=this.size,n=i.axis.properties,s=this.size.axis,o=this.dom.axis.frame,a=this.dom.axis.majorLines,r=n.majorLineNum;a.length>r?t=a[r]:(t=document.createElement("DIV"),t.className="timeline-axis-grid timeline-axis-grid-major",t.style.position="absolute",t.style.top="0px",t.style.width="0px",o.appendChild(t),a.push(t)),t.style.left=e-s.lineMajorWidth/2+"px",t.style.height=i.frameHeight+"px",n.majorLineNum++},links.Timeline.prototype.reflowItems=function(){var e,t,i,n=!1,s=(this.dom,this.groups),o=this.visibleItems;for(s&&s.forEach(function(e){e.itemsHeight=0}),e=0,t=o.length;t>e;e++){var a=o[e],r=a.dom;if(i=a.group,r){var l=r?r.clientWidth:0,h=r?r.clientHeight:0;n=n||a.width!=l,n=n||a.height!=h,a.width=l,a.height=h,a.reflow()}i&&(i.itemsHeight=i.itemsHeight?Math.max(i.itemsHeight,a.height):a.height)}return n},links.Timeline.prototype.recalcItems=function(){var e,t,i,n,s,o,a=!1,r=this.groups,l=this.size,h=this.options,m=this.visibleItems,p=0;if(0==r.length){if(h.autoHeight||h.cluster){var c=0,d=0;if(this.stack&&this.stack.finalItems)for(s=this.stack.finalItems,n=s[0],n&&n.top&&(c=n.top,d=n.top+n.height),e=1,t=s.length;t>e;e++)n=s[e],c=Math.min(c,n.top),d=Math.max(d,n.top+n.height);else for(i=m[0],i&&i.top&&(c=i.top,d=i.top+i.height),e=1,t=m.length;t>e;e++)i=m[e],i.top&&(c=Math.min(c,i.top),d=Math.max(d,i.top+i.height));if(p=d-c+2*h.eventMarginAxis+l.axis.height,h.minHeight>p&&(p=h.minHeight),l.actualHeight!=p&&h.autoHeight&&!h.axisOnTop){var u=p-l.actualHeight;if(this.stack&&this.stack.finalItems)for(s=this.stack.finalItems,e=0,t=s.length;t>e;e++)s[e].top+=u,s[e].item.top+=u;else for(e=0,t=m.length;t>e;e++)m[e].top+=u}}}else{for(p=l.axis.height+2*h.eventMarginAxis,e=0,t=r.length;t>e;e++){o=r[e];var g=Math.max(o.labelHeight||0,o.itemsHeight||0);a=a||g!=o.height,o.height=g,p+=r[e].height+h.eventMargin}var f=h.eventMargin,v=h.axisOnTop?h.eventMarginAxis+f/2:l.contentHeight-h.eventMarginAxis+f/2,T=l.axis.height;for(e=0,t=r.length;t>e;e++)o=r[e],h.axisOnTop?(o.top=v+T,o.labelTop=v+T+(o.height-o.labelHeight)/2,o.lineTop=v+T+o.height+f/2,v+=o.height+f):(v-=o.height+f,o.top=v,o.labelTop=v+(o.height-o.labelHeight)/2,o.lineTop=v-f/2);for(e=0,t=m.length;t>e;e++)i=m[e],o=i.group,o&&(i.top=o.top);a=!0}return h.minHeight>p&&(p=h.minHeight),a=a||p!=l.actualHeight,l.actualHeight=p,a},links.Timeline.prototype.clearItems=function(){for(var e=this.visibleItems,t=0,i=e.length;i>t;t++)this.visibleItems[t].visible=!1;this.repaintItems(),this.items=[],this.visibleItems=[],this.clusterFactory.clear()},links.Timeline.prototype.repaintItems=function(){var e,t,i,n=!1,s=this.dom,o=this.size,a=this.items;s.items||(s.items={});var r=s.items.frame;r||(r=document.createElement("DIV"),r.style.position="relative",s.content.appendChild(r),s.items.frame=r),r.style.left="0px",r.style.top=o.items.top+"px",r.style.height="0px",s.content.removeChild(r);var l,h=[];a.forEach(function(e){l=e.repaint(r),n=n||l,l&&e.getImageUrls(h)});var m=this.clusterFactory.getClusters(this.conversion.factor);m!=this.clusters&&(this.clusters&&this.clusters.forEach(function(e){e.hideDOM(r),e.items.forEach(function(e){delete e.cluster})}),m.forEach(function(e){var t=e.repaint(r);n=n||t,t&&e.getImageUrls(h),e.items.forEach(function(t){t.cluster=e})}),this.clusters=m,n=!0),m.forEach(function(e){l=e.repaint(r),n=n||l,l&&e.getImageUrls(h)});var p=this.visibleItems;for(e=0,t=p.length;t>e;e++)i=p[e],i.updatePosition(this);if(this.repaintDeleteButton(),this.repaintDragAreas(),s.content.appendChild(r),h.length){var c=this,d=function(){c.render()},u=!1;links.imageloader.loadAll(h,d,u)}return n},links.Timeline.prototype.reflowGroups=function(){for(var e=!1,t=this.options,i=this.size,n=this.dom,s=0,o=this.groups,a=this.dom.groups?this.dom.groups.labels:[],r=0,l=o.length;l>r;r++){var h=o[r],m=a[r];h.labelWidth=m?m.clientWidth:0,h.labelHeight=m?m.clientHeight:0,h.width=h.labelWidth,s=Math.max(s,h.width)}void 0!==t.groupsWidth&&(s=n.groups.frame?n.groups.frame.clientWidth:0),s+=1;var p=t.groupsOnRight?i.frameWidth-s:0;return e=e||i.groupsWidth!==s,e=e||i.groupsLeft!==p,i.groupsWidth=s,i.groupsLeft=p,e},links.Timeline.prototype.repaintGroups=function(){var e=this.dom,t=this.options,i=this.size,n=this.groups;void 0===e.groups&&(e.groups={});var s=e.groups.labels;s||(s=[],e.groups.labels=s);var o=e.groups.labelLines;o||(o=[],e.groups.labelLines=o);var a=e.groups.itemLines;a||(a=[],e.groups.itemLines=a);var r=e.groups.frame;r||(r=document.createElement("DIV"),r.className="timeline-groups-axis",r.style.position="absolute",r.style.overflow="hidden",r.style.top="0px",r.style.height="100%",e.frame.appendChild(r),e.groups.frame=r),r.style.left=i.groupsLeft+"px",r.style.width=void 0!==t.groupsWidth?t.groupsWidth:i.groupsWidth+"px",r.style.display=0==n.length?"none":"";for(var l=s.length,h=n.length,m=0,p=Math.min(l,h);p>m;m++){var c=n[m],d=s[m];d.innerHTML=this.getGroupName(c),d.style.display=""}for(var m=l;h>m;m++){var c=n[m],d=document.createElement("DIV");d.className="timeline-groups-text",d.style.position="absolute",void 0===t.groupsWidth&&(d.style.whiteSpace="nowrap"),d.innerHTML=this.getGroupName(c),r.appendChild(d),s[m]=d;var u=document.createElement("DIV");u.className="timeline-axis-grid timeline-axis-grid-minor",u.style.position="absolute",u.style.left="0px",u.style.width="100%",u.style.height="0px",u.style.borderTopStyle="solid",r.appendChild(u),o[m]=u;var g=document.createElement("DIV");g.className="timeline-axis-grid timeline-axis-grid-minor",g.style.position="absolute",g.style.left="0px",g.style.width="100%",g.style.height="0px",g.style.borderTopStyle="solid",e.content.insertBefore(g,e.content.firstChild),a[m]=g}for(var m=h;l>m;m++){var d=s[m],u=o[m],g=a[m];r.removeChild(d),r.removeChild(u),e.content.removeChild(g)}s.splice(h,l-h),o.splice(h,l-h),a.splice(h,l-h),r.style.borderStyle=t.groupsOnRight?"none none none solid":"none solid none none";for(var m=0,p=n.length;p>m;m++){var c=n[m],d=s[m],u=o[m],g=a[m];d.style.top=c.labelTop+"px",u.style.top=c.lineTop+"px",g.style.top=c.lineTop+"px",g.style.width=i.contentWidth+"px"}if(!e.groups.background){var f=document.createElement("DIV");f.className="timeline-axis",f.style.position="absolute",f.style.left="0px",f.style.width="100%",f.style.border="none",r.appendChild(f),e.groups.background=f}if(e.groups.background.style.top=i.axis.top+"px",e.groups.background.style.height=i.axis.height+"px",!e.groups.line){var v=document.createElement("DIV");v.className="timeline-axis",v.style.position="absolute",v.style.left="0px",v.style.width="100%",v.style.height="0px",r.appendChild(v),e.groups.line=v}if(e.groups.line.style.top=i.axis.line+"px",e.groups.frame&&n.length){var T=[];if(links.imageloader.filterImageUrls(e.groups.frame,T),T.length){var k=function(){timeline.render()},y=!1;links.imageloader.loadAll(T,k,y)}}},links.Timeline.prototype.repaintCurrentTime=function(){var e=this.options,t=this.dom,i=this.size;if(!e.showCurrentTime)return t.currentTime&&(t.contentTimelines.removeChild(t.currentTime),delete t.currentTime),void 0;if(!t.currentTime){var n=document.createElement("DIV");n.className="timeline-currenttime",n.style.position="absolute",n.style.top="0px",n.style.height="100%",t.contentTimelines.appendChild(n),t.currentTime=n}var s=new Date,o=new Date(s.getTime()+this.clientTimeOffset),a=this.timeToScreen(o),r=a>-i.contentWidth&&2*i.contentWidth>a;t.currentTime.style.display=r?"":"none",t.currentTime.style.left=a+"px",t.currentTime.title="Current time: "+o,void 0!=this.currentTimeTimer&&(clearTimeout(this.currentTimeTimer),delete this.currentTimeTimer);var l=this,h=function(){l.repaintCurrentTime()},m=1/this.conversion.factor/2;30>m&&(m=30),this.currentTimeTimer=setTimeout(h,m)},links.Timeline.prototype.repaintCustomTime=function(){var e=this.options,t=this.dom,i=this.size;if(!e.showCustomTime)return t.customTime&&(t.contentTimelines.removeChild(t.customTime),delete t.customTime),void 0;if(!t.customTime){var n=document.createElement("DIV");n.className="timeline-customtime",n.style.position="absolute",n.style.top="0px",n.style.height="100%";var s=document.createElement("DIV");s.style.position="relative",s.style.top="0px",s.style.left="-10px",s.style.height="100%",s.style.width="20px",n.appendChild(s),t.contentTimelines.appendChild(n),t.customTime=n,this.customTime=new Date}var o=this.timeToScreen(this.customTime),a=o>-i.contentWidth&&2*i.contentWidth>o;t.customTime.style.display=a?"":"none",t.customTime.style.left=o+"px",t.customTime.title="Time: "+this.customTime},links.Timeline.prototype.repaintDeleteButton=function(){var e=(this.options,this.dom),t=(this.size,e.items.frame),i=e.items.deleteButton;i||(i=document.createElement("DIV"),i.className="timeline-navigation-delete",i.style.position="absolute",t.appendChild(i),e.items.deleteButton=i);var n=this.selection?this.selection.index:-1,s=this.selection?this.items[n]:void 0;if(s&&s.visible&&this.isEditable(s)){var o=s.getRight(this),a=s.top;i.style.left=o+"px",i.style.top=a+"px",i.style.display="",t.removeChild(i),t.appendChild(i)}else i.style.display="none"},links.Timeline.prototype.repaintDragAreas=function(){var e=this.options,t=this.dom,i=this.dom.items.frame,n=t.items.dragLeft;n||(n=document.createElement("DIV"),n.className="timeline-event-range-drag-left",n.style.width=e.dragAreaWidth+"px",n.style.position="absolute",i.appendChild(n),t.items.dragLeft=n);var s=t.items.dragRight;s||(s=document.createElement("DIV"),s.className="timeline-event-range-drag-right",s.style.width=e.dragAreaWidth+"px",s.style.position="absolute",i.appendChild(s),t.items.dragRight=s);var o=this.selection?this.selection.index:-1,a=this.selection?this.items[o]:void 0;if(a&&a.visible&&this.isEditable(a)&&a instanceof links.Timeline.ItemRange){var r=this.timeToScreen(a.start),l=this.timeToScreen(a.end),h=a.top,m=a.height;n.style.left=r+"px",n.style.top=h+"px",n.style.height=m+"px",n.style.display="",i.removeChild(n),i.appendChild(n),s.style.left=l-e.dragAreaWidth+"px",s.style.top=h+"px",s.style.height=m+"px",s.style.display="",i.removeChild(s),i.appendChild(s)}else n.style.display="none",s.style.display="none"},links.Timeline.prototype.repaintNavigation=function(){var e=this,t=this.options,i=this.dom,n=i.frame,s=i.navBar;if(!s){if((t.showNavigation||t.showButtonNew)&&(s=document.createElement("DIV"),s.style.position="absolute",s.className="timeline-navigation",t.groupsOnRight?s.style.left="10px":s.style.right="10px",t.axisOnTop?s.style.bottom="10px":s.style.top="10px",i.navBar=s,n.appendChild(s)),t.editable&&t.showButtonNew){s.addButton=document.createElement("DIV"),s.addButton.className="timeline-navigation-new",s.addButton.title="Create new event";var o=function(i){links.Timeline.preventDefault(i),links.Timeline.stopPropagation(i);var n=e.size.contentWidth,s=n/2,o=e.screenToTime(s-n/10),a=e.screenToTime(s+n/10);t.snapEvents&&(e.step.snap(o),e.step.snap(a));var r="New",l=e.groups.length?e.groups[0].content:void 0;e.addItem({start:o,end:a,content:r,group:l});var h=e.items.length-1;e.selectItem(h),e.applyAdd=!0,e.trigger("add"),e.applyAdd||e.deleteItem(h)};links.Timeline.addEventListener(s.addButton,"mousedown",o),s.appendChild(s.addButton)}if(t.editable&&t.showButtonNew&&t.showNavigation&&(s.addButton.style.borderRightWidth="1px",s.addButton.style.borderRightStyle="solid"),t.showNavigation){s.zoomInButton=document.createElement("DIV"),s.zoomInButton.className="timeline-navigation-zoom-in",s.zoomInButton.title="Zoom in";var a=function(t){links.Timeline.preventDefault(t),links.Timeline.stopPropagation(t),e.zoom(.4),e.trigger("rangechange"),e.trigger("rangechanged")};links.Timeline.addEventListener(s.zoomInButton,"mousedown",a),s.appendChild(s.zoomInButton),s.zoomOutButton=document.createElement("DIV"),s.zoomOutButton.className="timeline-navigation-zoom-out",s.zoomOutButton.title="Zoom out";var r=function(t){links.Timeline.preventDefault(t),links.Timeline.stopPropagation(t),e.zoom(-.4),e.trigger("rangechange"),e.trigger("rangechanged")};links.Timeline.addEventListener(s.zoomOutButton,"mousedown",r),s.appendChild(s.zoomOutButton),s.moveLeftButton=document.createElement("DIV"),s.moveLeftButton.className="timeline-navigation-move-left",s.moveLeftButton.title="Move left";var l=function(t){links.Timeline.preventDefault(t),links.Timeline.stopPropagation(t),e.move(-.2),e.trigger("rangechange"),e.trigger("rangechanged")};links.Timeline.addEventListener(s.moveLeftButton,"mousedown",l),s.appendChild(s.moveLeftButton),s.moveRightButton=document.createElement("DIV"),s.moveRightButton.className="timeline-navigation-move-right",s.moveRightButton.title="Move right";var h=function(t){links.Timeline.preventDefault(t),links.Timeline.stopPropagation(t),e.move(.2),e.trigger("rangechange"),e.trigger("rangechanged")};links.Timeline.addEventListener(s.moveRightButton,"mousedown",h),s.appendChild(s.moveRightButton)}}},links.Timeline.prototype.setCurrentTime=function(e){var t=new Date;this.clientTimeOffset=e.getTime()-t.getTime(),this.repaintCurrentTime()},links.Timeline.prototype.getCurrentTime=function(){var e=new Date;return new Date(e.getTime()+this.clientTimeOffset)},links.Timeline.prototype.setCustomTime=function(e){this.customTime=new Date(e),this.repaintCustomTime()},links.Timeline.prototype.getCustomTime=function(){return new Date(this.customTime)},links.Timeline.prototype.setScale=function(e,t){this.step.setScale(e,t),this.render()},links.Timeline.prototype.setAutoScale=function(e){this.step.setAutoScale(e),this.render()},links.Timeline.prototype.redraw=function(){this.setData(this.data)},links.Timeline.prototype.checkResize=function(){this.render()},links.Timeline.prototype.isEditable=function(e){return e?void 0!=e.editable?e.editable:this.options.editable:!1},links.Timeline.prototype.recalcConversion=function(){this.conversion.offset=parseFloat(this.start.valueOf()),this.conversion.factor=parseFloat(this.size.contentWidth)/parseFloat(this.end.valueOf()-this.start.valueOf())},links.Timeline.prototype.screenToTime=function(e){var t=this.conversion,i=new Date(parseFloat(e)/t.factor+t.offset);return i},links.Timeline.prototype.timeToScreen=function(e){var t=this.conversion,i=(e.valueOf()-t.offset)*t.factor;return i},links.Timeline.prototype.onTouchStart=function(e){var t=this.eventParams,i=this;if(!t.touchDown){t.touchDown=!0,t.zoomed=!1,this.onMouseDown(e),t.onTouchMove||(t.onTouchMove=function(e){i.onTouchMove(e)},links.Timeline.addEventListener(document,"touchmove",t.onTouchMove)),t.onTouchEnd||(t.onTouchEnd=function(e){i.onTouchEnd(e)},links.Timeline.addEventListener(document,"touchend",t.onTouchEnd));var n=links.Timeline.getTarget(e),s=this.getItemIndex(n);t.doubleTapStartPrev=t.doubleTapStart,t.doubleTapStart=(new Date).getTime(),t.doubleTapItemPrev=t.doubleTapItem,t.doubleTapItem=s,links.Timeline.preventDefault(e)}},links.Timeline.prototype.onTouchMove=function(e){var t=this.eventParams;if(e.scale&&1!==e.scale&&(t.zoomed=!0),t.zoomed){if(this.options.zoomable){t.zoomed=!0;var i=e.scale,n=t.end.valueOf()-t.start.valueOf(),s=n/i,o=s-n,a=new Date(parseInt(t.start.valueOf()-o/2)),r=new Date(parseInt(t.end.valueOf()+o/2));this.setVisibleChartRange(a,r),this.trigger("rangechange")}}else this.onMouseMove(e);links.Timeline.preventDefault(e)},links.Timeline.prototype.onTouchEnd=function(e){var t=this.eventParams,i=this;t.touchDown=!1,t.zoomed&&this.trigger("rangechanged"),t.onTouchMove&&(links.Timeline.removeEventListener(document,"touchmove",t.onTouchMove),delete t.onTouchMove),t.onTouchEnd&&(links.Timeline.removeEventListener(document,"touchend",t.onTouchEnd),delete t.onTouchEnd),this.onMouseUp(e);var n=500,s=(new Date).getTime(),o=links.Timeline.getTarget(e);this.getItemIndex(o),t.doubleTapStartPrev&&n>s-t.doubleTapStartPrev&&t.doubleTapItem==t.doubleTapItemPrev&&(t.touchDown=!0,i.onDblClick(e),t.touchDown=!1),links.Timeline.preventDefault(e)},links.Timeline.prototype.onMouseDown=function(e){e=e||window.event;var t=this.eventParams,i=this.options,n=this.dom,s=e.which?1==e.which:1==e.button;if(s||t.touchDown){t.touchDown?(t.mouseX=e.targetTouches[0].clientX,t.mouseY=e.targetTouches[0].clientY):(t.mouseX=e.clientX,t.mouseY=e.clientY),void 0===t.mouseX&&(t.mouseX=0),void 0===t.mouseY&&(t.mouseY=0),t.frameLeft=links.Timeline.getAbsoluteLeft(this.dom.content),t.frameTop=links.Timeline.getAbsoluteTop(this.dom.content),t.previousLeft=0,t.previousOffset=0,t.moved=!1,t.start=new Date(this.start),t.end=new Date(this.end),t.target=links.Timeline.getTarget(e);
var o=n.items&&n.items.dragLeft?n.items.dragLeft:void 0,a=n.items&&n.items.dragRight?n.items.dragRight:void 0;if(t.itemDragLeft=t.target===o,t.itemDragRight=t.target===a,t.itemIndex=t.itemDragLeft||t.itemDragRight?this.selection?this.selection.index:void 0:this.getItemIndex(t.target),t.customTime=t.target===n.customTime||t.target.parentNode===n.customTime?this.customTime:void 0,t.addItem=i.editable&&(e.shiftKey||e.ctrlKey),t.addItem){var r=t.mouseX-t.frameLeft,l=t.mouseY-t.frameTop,h=this.screenToTime(r);i.snapEvents&&this.step.snap(h);var m=new Date(h),p="New",c=this.getGroupFromHeight(l);this.addItem({start:h,end:m,content:p,group:this.getGroupName(c)}),t.itemIndex=this.items.length-1,this.selectItem(t.itemIndex),t.itemDragRight=!0}var d=this.items[t.itemIndex],u=this.isSelected(t.itemIndex);if(t.editItem=u&&this.isEditable(d),t.editItem?(t.itemStart=d.start,t.itemEnd=d.end,t.itemGroup=d.group,t.itemLeft=d.start?this.timeToScreen(d.start):void 0,t.itemRight=d.end?this.timeToScreen(d.end):void 0):this.dom.frame.style.cursor="move",!t.touchDown){var g=this;t.onMouseMove||(t.onMouseMove=function(e){g.onMouseMove(e)},links.Timeline.addEventListener(document,"mousemove",t.onMouseMove)),t.onMouseUp||(t.onMouseUp=function(e){g.onMouseUp(e)},links.Timeline.addEventListener(document,"mouseup",t.onMouseUp)),links.Timeline.preventDefault(e)}}},links.Timeline.prototype.onMouseMove=function(e){e=e||window.event;var t,i,n=this.eventParams,s=this.size,o=this.dom,a=this.options;n.touchDown?(t=e.targetTouches[0].clientX,i=e.targetTouches[0].clientY):(t=e.clientX,i=e.clientY),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n.mouseX&&(n.mouseX=t),void 0===n.mouseY&&(n.mouseY=i);var r=parseFloat(t)-n.mouseX;if(parseFloat(i)-n.mouseY,Math.abs(r)>=1&&(n.moved=!0),n.customTime){var l=this.timeToScreen(n.customTime),h=l+r;this.customTime=this.screenToTime(h),this.repaintCustomTime(),this.trigger("timechange")}else if(n.editItem){var m,p,c=this.items[n.itemIndex];if(n.itemDragLeft?(m=n.itemLeft+r,p=n.itemRight,c.start=this.screenToTime(m),a.snapEvents&&(this.step.snap(c.start),m=this.timeToScreen(c.start)),m>p&&(m=p,c.start=this.screenToTime(m))):n.itemDragRight?(m=n.itemLeft,p=n.itemRight+r,c.end=this.screenToTime(p),a.snapEvents&&(this.step.snap(c.end),p=this.timeToScreen(c.end)),m>p&&(p=m,c.end=this.screenToTime(p))):(m=n.itemLeft+r,c.start=this.screenToTime(m),a.snapEvents&&(this.step.snap(c.start),m=this.timeToScreen(c.start)),c.end&&(p=m+(n.itemRight-n.itemLeft),c.end=this.screenToTime(p))),c.setPosition(m,p),0==this.groups.length)this.render();else{var d=i-n.frameTop,u=this.getGroupFromHeight(d);if(a.groupsChangeable&&c.group!==u){var g=this.items.indexOf(c);this.changeItem(g,{group:this.getGroupName(u)})}else this.repaintDeleteButton(),this.repaintDragAreas()}}else if(a.moveable){var f=n.end.valueOf()-n.start.valueOf(),v=Math.round(parseFloat(-r)/s.contentWidth*f),T=new Date(n.start.valueOf()+v),k=new Date(n.end.valueOf()+v);this.applyRange(T,k);var y=this.start.valueOf()-T.valueOf();y&&(v+=y),this.recalcConversion();var D=n.previousLeft||0,x=parseFloat(o.items.frame.style.left)||0,S=n.previousOffset||0,M=S+(x-D),C=-v/f*s.contentWidth+M;o.items.frame.style.left=C+"px",n.previousOffset=M,n.previousLeft=parseFloat(o.items.frame.style.left)||C,this.repaintCurrentTime(),this.repaintCustomTime(),this.repaintAxis(),this.trigger("rangechange")}links.Timeline.preventDefault(e)},links.Timeline.prototype.onMouseUp=function(e){var t=this.eventParams,i=this.options;if(e=e||window.event,this.dom.frame.style.cursor="auto",t.onMouseMove&&(links.Timeline.removeEventListener(document,"mousemove",t.onMouseMove),delete t.onMouseMove),t.onMouseUp&&(links.Timeline.removeEventListener(document,"mouseup",t.onMouseUp),delete t.onMouseUp),t.customTime)this.trigger("timechanged");else if(t.editItem){var n=this.items[t.itemIndex];if(t.moved||t.addItem){if(this.applyChange=!0,this.applyAdd=!0,this.updateData(t.itemIndex,{start:n.start,end:n.end}),this.trigger(t.addItem?"add":"change"),t.addItem)this.applyAdd?this.updateData(t.itemIndex,{start:n.start,end:n.end,content:n.content,group:this.getGroupName(n.group)}):this.deleteItem(t.itemIndex);else if(this.applyChange)this.updateData(t.itemIndex,{start:n.start,end:n.end});else{delete this.applyChange,delete this.applyAdd;var n=this.items[t.itemIndex];n.dom,n.start=t.itemStart,n.end=t.itemEnd,n.group=t.itemGroup,n.setPosition(t.itemLeft,t.itemRight)}this.render()}}else t.moved||t.zoomed?(this.render(),(t.moved&&i.moveable||t.zoomed&&i.zoomable)&&this.trigger("rangechanged")):t.target===this.dom.items.deleteButton?this.selection&&this.confirmDeleteItem(this.selection.index):i.selectable&&(void 0!==t.itemIndex?this.isSelected(t.itemIndex)||(this.selectItem(t.itemIndex),this.trigger("select")):(this.unselectItem(),this.trigger("select")))},links.Timeline.prototype.onDblClick=function(e){var t=this.eventParams,i=this.options,n=this.dom,s=this.size;if(e=e||window.event,void 0!==t.itemIndex){var o=this.items[t.itemIndex];o&&this.isEditable(o)&&this.trigger("edit")}else if(i.editable){t.touchDown||(t.mouseX=e.clientX,t.mouseY=e.clientY),void 0===t.mouseX&&(t.mouseX=0),void 0===t.mouseY&&(t.mouseY=0);var a=t.mouseX-links.Timeline.getAbsoluteLeft(n.content),r=t.mouseY-links.Timeline.getAbsoluteTop(n.content),l=this.screenToTime(a),h=this.screenToTime(a+s.frameWidth/10);i.snapEvents&&(this.step.snap(l),this.step.snap(h));var m="New",p=this.getGroupFromHeight(r);this.addItem({start:l,end:h,content:m,group:this.getGroupName(p)}),t.itemIndex=this.items.length-1,this.selectItem(t.itemIndex),this.applyAdd=!0,this.trigger("add"),this.applyAdd||this.deleteItem(t.itemIndex)}links.Timeline.preventDefault(e)},links.Timeline.prototype.onMouseWheel=function(e){if(this.options.zoomable){e||(e=window.event);var t=0;if(e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),t){var i=this,n=function(){var n=t/5,s=links.Timeline.getAbsoluteLeft(i.dom.content),o=void 0!=e.clientX&&void 0!=s?i.screenToTime(e.clientX-s):void 0;i.zoom(n,o),i.trigger("rangechange"),i.trigger("rangechanged")};n()}links.Timeline.preventDefault(e)}},links.Timeline.prototype.zoom=function(e,t){void 0==t&&(t=new Date((this.start.valueOf()+this.end.valueOf())/2)),e>=1&&(e=.9),-1>=e&&(e=-.9),0>e&&(e/=1+e);var i=parseFloat(this.start.valueOf()-t.valueOf()),n=parseFloat(this.end.valueOf()-t.valueOf()),s=new Date(this.start.valueOf()-i*e),o=new Date(this.end.valueOf()-n*e);this.applyRange(s,o,t),this.render({animate:this.options.animate&&this.options.animateZoom})},links.Timeline.prototype.move=function(e){var t=parseFloat(this.end.valueOf()-this.start.valueOf()),i=new Date(this.start.valueOf()+t*e),n=new Date(this.end.valueOf()+t*e);this.applyRange(i,n),this.render()},links.Timeline.prototype.applyRange=function(e,t,i){var n=e.valueOf(),s=t.valueOf(),o=s-n,a=this.options,r=31536e6,l=Number(a.intervalMin)||10;10>l&&(l=10);var h=Number(a.intervalMax)||1e4*r;h>1e4*r&&(h=1e4*r),l>h&&(h=l);var m=a.min?a.min.valueOf():void 0,p=a.max?a.max.valueOf():void 0;if(void 0!=m&&void 0!=p){if(m>=p){var c=864e5;p=m+c}h>p-m&&(h=p-m),l>p-m&&(l=p-m)}if(n>=s&&(s+=864e5),l>o){var d=l-o,u=i?(i.valueOf()-n)/o:.5;n-=Math.round(d*u),s+=Math.round(d*(1-u))}if(o>h){var d=o-h,u=i?(i.valueOf()-n)/o:.5;n+=Math.round(d*u),s-=Math.round(d*(1-u))}if(void 0!=m){var d=n-m;0>d&&(n-=d,s-=d)}if(void 0!=p){var d=p-s;0>d&&(n+=d,s+=d)}this.start=new Date(n),this.end=new Date(s)},links.Timeline.prototype.confirmDeleteItem=function(e){this.applyDelete=!0,this.isSelected(e)||this.selectItem(e),this.trigger("delete"),this.applyDelete&&this.deleteItem(e),delete this.applyDelete},links.Timeline.prototype.deleteItem=function(e){if(e>=this.items.length)throw"Cannot delete row, index out of range";this.unselectItem();var t=this.items.splice(e,1)[0];if(t.deleteDOM(),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRow(e);else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(e,1)}this.render()},links.Timeline.prototype.deleteAllItems=function(){if(this.unselectItem(),this.clearItems(),this.deleteGroups(),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRows(0,this.data.getNumberOfRows());else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(0,this.data.length)}this.render()},links.Timeline.prototype.getGroupFromHeight=function(e){var t,i,n=this.groups;if(n){if(this.options.axisOnTop){for(t=n.length-1;t>=0;t--)if(i=n[t],e>i.top)return i}else for(t=0;n.length>t;t++)if(i=n[t],e>i.top)return i;return i}return void 0},links.Timeline.Item=function(e,t){if(e&&(this.start=e.start,this.end=e.end,this.content=e.content,this.className=e.className,this.editable=e.editable,this.group=e.group,this.start&&(this.center=this.end?(this.start.valueOf()+this.end.valueOf())/2:this.start.valueOf())),this.top=0,this.left=0,this.width=0,this.height=0,this.lineWidth=0,this.dotWidth=0,this.dotHeight=0,t)for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])},links.Timeline.Item.prototype.repaint=function(e){var t=!1;return this.visible?(this.dom||(this.dom=this.createDOM(),this.changed=!0,t=!0),this.domVisible||this.showDOM(e),this.changed&&(this.updateDOM(),this.changed=!1)):this.domVisible&&this.hideDOM(e),t},links.Timeline.Item.prototype.reflow=function(){return!1},links.Timeline.Item.prototype.getImageUrls=function(e){this.dom&&links.imageloader.filterImageUrls(this.dom,e)},links.Timeline.Item.prototype.select=function(){},links.Timeline.Item.prototype.unselect=function(){},links.Timeline.Item.prototype.createDOM=function(){},links.Timeline.Item.prototype.showDOM=function(){},links.Timeline.Item.prototype.hideDOM=function(){},links.Timeline.Item.prototype.updateDOM=function(){},links.Timeline.Item.prototype.deleteDOM=function(){this.hideDOM(),delete this.dom},links.Timeline.Item.prototype.updatePosition=function(){},links.Timeline.Item.prototype.updateVisible=function(){},links.Timeline.Item.prototype.setPosition=function(){},links.Timeline.Item.prototype.getRight=function(){return 0},links.Timeline.ItemBox=function(e,t){links.Timeline.Item.call(this,e,t)},links.Timeline.ItemBox.prototype=new links.Timeline.Item,links.Timeline.ItemBox.prototype.reflow=function(){var e=this.dom,t=e.dot.offsetHeight,i=e.dot.offsetWidth,n=e.line.offsetWidth,s=this.dotHeight!=t||this.dotWidth!=i||this.lineWidth!=n;return this.dotHeight=t,this.dotWidth=i,this.lineWidth=n,s},links.Timeline.ItemBox.prototype.select=function(){var e=this.dom;links.Timeline.addClassName(e,"timeline-event-selected"),links.Timeline.addClassName(e.line,"timeline-event-selected"),links.Timeline.addClassName(e.dot,"timeline-event-selected")},links.Timeline.ItemBox.prototype.unselect=function(){var e=this.dom;links.Timeline.removeClassName(e,"timeline-event-selected"),links.Timeline.removeClassName(e.line,"timeline-event-selected"),links.Timeline.removeClassName(e.dot,"timeline-event-selected")},links.Timeline.ItemBox.prototype.createDOM=function(){var e=document.createElement("DIV");e.style.position="absolute",e.style.left=this.left+"px",e.style.top=this.top+"px";var t=document.createElement("DIV");t.className="timeline-event-content",t.innerHTML=this.content,e.appendChild(t);var i=document.createElement("DIV");i.style.position="absolute",i.style.width="0px",e.line=i;var n=document.createElement("DIV");return n.style.position="absolute",n.style.width="0px",n.style.height="0px",e.dot=n,e},links.Timeline.ItemBox.prototype.showDOM=function(e){e.appendChild(this.dom),e.insertBefore(this.dom.line,e.firstChild),e.appendChild(this.dom.dot),this.domVisible=!0},links.Timeline.ItemBox.prototype.hideDOM=function(){var e=this.dom;if(e){var t=e.parentNode;t&&(t.removeChild(e),t.removeChild(e.line),t.removeChild(e.dot))}this.domVisible=!1},links.Timeline.ItemBox.prototype.updateDOM=function(){if(this.dom){var e=this.dom,t=e.line,i=e.dot;e.firstChild.innerHTML=this.content,e.className="timeline-event timeline-event-box",t.className="timeline-event timeline-event-line",i.className="timeline-event timeline-event-dot",this.isCluster&&(links.Timeline.addClassName(e,"timeline-event-cluster"),links.Timeline.addClassName(t,"timeline-event-cluster"),links.Timeline.addClassName(i,"timeline-event-cluster")),this.className&&(links.Timeline.addClassName(e,this.className),links.Timeline.addClassName(t,this.className),links.Timeline.addClassName(i,this.className))}},links.Timeline.ItemBox.prototype.updatePosition=function(e){var t=this.dom,i=e.timeToScreen(this.start),n=e.options.axisOnTop,s=e.size.axis.top,o=e.size.axis.height,a=e.options.box&&e.options.box.align?e.options.box.align:void 0;t.style.top=this.top+"px",t.style.left="right"==a?i-this.width+"px":"left"==a?i+"px":i-this.width/2+"px";var r=t.line,l=t.dot;r.style.left=i-this.lineWidth/2+"px",l.style.left=i-this.dotWidth/2+"px",n?(r.style.top=o+"px",r.style.height=Math.max(this.top-o,0)+"px",l.style.top=o-this.dotHeight/2+"px"):(r.style.top=this.top+this.height+"px",r.style.height=Math.max(s-this.top-this.height,0)+"px",l.style.top=s-this.dotHeight/2+"px")},links.Timeline.ItemBox.prototype.updateVisible=function(e){var t=e.timeToScreen(this.start),i=e.size.contentWidth;this.visible=t+this.width/2>-i&&2*i>t-this.width/2&&!this.cluster},links.Timeline.ItemBox.prototype.setPosition=function(e){var t=this.dom;t.style.left=e-this.width/2+"px",t.line.style.left=e-this.lineWidth/2+"px",t.dot.style.left=e-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,t.style.top=this.top+"px")},links.Timeline.ItemBox.prototype.getRight=function(e){var t,i=e.options.box&&e.options.box.align?e.options.box.align:void 0,n=e.timeToScreen(this.start);return t="right"==i?n:"left"==i?n+this.width:n+this.width/2},links.Timeline.ItemRange=function(e,t){links.Timeline.Item.call(this,e,t)},links.Timeline.ItemRange.prototype=new links.Timeline.Item,links.Timeline.ItemRange.prototype.select=function(){var e=this.dom;links.Timeline.addClassName(e,"timeline-event-selected")},links.Timeline.ItemRange.prototype.unselect=function(){var e=this.dom;links.Timeline.removeClassName(e,"timeline-event-selected")},links.Timeline.ItemRange.prototype.createDOM=function(){var e=document.createElement("DIV");e.style.position="absolute";var t=document.createElement("DIV");return t.className="timeline-event-content",e.appendChild(t),e},links.Timeline.ItemRange.prototype.showDOM=function(e){e.appendChild(this.dom),this.domVisible=!0},links.Timeline.ItemRange.prototype.hideDOM=function(){var e=this.dom;if(e){var t=e.parentNode;t&&t.removeChild(e)}this.domVisible=!1},links.Timeline.ItemRange.prototype.updateDOM=function(){if(this.dom){var e=this.dom;e.firstChild.innerHTML=this.content,e.className="timeline-event timeline-event-range",this.isCluster&&links.Timeline.addClassName(e,"timeline-event-cluster"),this.className&&links.Timeline.addClassName(e,this.className)}},links.Timeline.ItemRange.prototype.updatePosition=function(e){var t=this.dom,i=e.size.contentWidth,n=e.timeToScreen(this.start),s=e.timeToScreen(this.end);-i>n&&(n=-i),s>2*i&&(s=2*i),t.style.top=this.top+"px",t.style.left=n+"px",t.style.width=Math.max(s-n,1)+"px"},links.Timeline.ItemRange.prototype.updateVisible=function(e){var t=e.timeToScreen(this.start),i=e.timeToScreen(this.end),n=e.size.contentWidth;this.visible=i>-n&&2*n>t&&!this.cluster},links.Timeline.ItemRange.prototype.setPosition=function(e,t){var i=this.dom;i.style.left=e+"px",i.style.width=t-e+"px",this.group&&(this.top=this.group.top,i.style.top=this.top+"px")},links.Timeline.ItemRange.prototype.getRight=function(e){return e.timeToScreen(this.end)},links.Timeline.ItemDot=function(e,t){links.Timeline.Item.call(this,e,t)},links.Timeline.ItemDot.prototype=new links.Timeline.Item,links.Timeline.ItemDot.prototype.reflow=function(){var e=this.dom,t=e.dot.offsetHeight,i=e.dot.offsetWidth,n=e.content.offsetHeight,s=this.dotHeight!=t||this.dotWidth!=i||this.contentHeight!=n;return this.dotHeight=t,this.dotWidth=i,this.contentHeight=n,s},links.Timeline.ItemDot.prototype.select=function(){var e=this.dom;links.Timeline.addClassName(e,"timeline-event-selected")},links.Timeline.ItemDot.prototype.unselect=function(){var e=this.dom;links.Timeline.removeClassName(e,"timeline-event-selected")},links.Timeline.ItemDot.prototype.createDOM=function(){var e=document.createElement("DIV");e.style.position="absolute";var t=document.createElement("DIV");t.className="timeline-event-content",e.appendChild(t);var i=document.createElement("DIV");return i.style.position="absolute",i.style.width="0px",i.style.height="0px",e.appendChild(i),e.content=t,e.dot=i,e},links.Timeline.ItemDot.prototype.showDOM=function(e){e.appendChild(this.dom),this.domVisible=!0},links.Timeline.ItemDot.prototype.hideDOM=function(){var e=this.dom;if(e){var t=e.parentNode;t&&t.removeChild(e)}this.domVisible=!1},links.Timeline.ItemDot.prototype.updateDOM=function(){if(this.dom){var e=this.dom,t=e.dot;e.firstChild.innerHTML=this.content,t.className="timeline-event timeline-event-dot",this.isCluster&&(links.Timeline.addClassName(e,"timeline-event-cluster"),links.Timeline.addClassName(t,"timeline-event-cluster")),this.className&&(links.Timeline.addClassName(e,this.className),links.Timeline.addClassName(t,this.className))}},links.Timeline.ItemDot.prototype.updatePosition=function(e){var t=this.dom,i=e.timeToScreen(this.start);t.style.top=this.top+"px",t.style.left=i-this.dotWidth/2+"px",t.content.style.marginLeft=1.5*this.dotWidth+"px",t.dot.style.top=(this.height-this.dotHeight)/2+"px"},links.Timeline.ItemDot.prototype.updateVisible=function(e){var t=e.timeToScreen(this.start),i=e.size.contentWidth;this.visible=t+this.width>-i&&2*i>t&&!this.cluster},links.Timeline.ItemDot.prototype.setPosition=function(e){var t=this.dom;t.style.left=e-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,t.style.top=this.top+"px")},links.Timeline.ItemDot.prototype.getRight=function(e){return e.timeToScreen(this.start)+this.width},links.Timeline.prototype.getItem=function(e){if(e>=this.items.length)throw"Cannot get item, index out of range";var t=this.items[e],i={};return i.start=new Date(t.start),t.end&&(i.end=new Date(t.end)),i.content=t.content,t.group&&(i.group=this.getGroupName(t.group)),i},links.Timeline.prototype.addItem=function(e){var t=[e];this.addItems(t)},links.Timeline.prototype.addItems=function(e){for(var t=e,i=this.items,n=0,s=t.length;s>n;n++){var o=e[n];i.push(this.createItem(o));var a=i.length-1;this.updateData(a,o)}this.render({animate:!1})},links.Timeline.prototype.createItem=function(e){var t,i=e.end?"range":this.options.style,n={start:e.start,end:e.end,content:e.content,className:e.className,editable:e.editable,group:this.getGroup(e.group)},s=this.options;switch(t=s.axisOnTop?this.size.axis.height+s.eventMarginAxis+s.eventMargin/2:this.size.contentHeight-s.eventMarginAxis-s.eventMargin/2,i){case"box":return new links.Timeline.ItemBox(n,{top:t});case"range":return new links.Timeline.ItemRange(n,{top:t});case"dot":return new links.Timeline.ItemDot(n,{top:t})}return console.log('ERROR: Unknown event style "'+i+'"'),new links.Timeline.Item(n,{top:t})},links.Timeline.prototype.changeItem=function(e,t){var i=this.items[e];if(!i)throw"Cannot change item, index out of range";i.deleteDOM();var n=this.createItem({start:t.hasOwnProperty("start")?t.start:i.start,end:t.hasOwnProperty("end")?t.end:i.end,content:t.hasOwnProperty("content")?t.content:i.content,group:t.hasOwnProperty("group")?t.group:this.getGroupName(i.group)});this.items[e]=n,this.updateData(e,t),this.render({animate:!1}),n.select()},links.Timeline.prototype.deleteGroups=function(){this.groups=[],this.groupIndexes={}},links.Timeline.prototype.getGroup=function(e){var t=this.groups,i=this.groupIndexes,n=void 0,s=i[e];if(void 0===s&&void 0!==e){n={content:e,labelTop:0,lineTop:0},t.push(n),t=t.sort(function(e,t){return e.content>t.content?1:e.content<t.content?-1:0});for(var o=0,a=t.length;a>o;o++)i[t[o].content]=o}else n=t[s];return n},links.Timeline.prototype.getGroupName=function(e){return e?e.content:void 0},links.Timeline.prototype.cancelChange=function(){this.applyChange=!1},links.Timeline.prototype.cancelDelete=function(){this.applyDelete=!1},links.Timeline.prototype.cancelAdd=function(){this.applyAdd=!1},links.Timeline.prototype.setSelection=function(e){if(void 0!=e&&e.length>0){if(void 0!=e[0].row){var t=e[0].row;if(this.items[t]){var i=this.items[t];this.selectItem(t);var n,s=i.start,o=i.end;n=void 0!=o?new Date((o.valueOf()+s.valueOf())/2):new Date(s);var a=this.end.valueOf()-this.start.valueOf(),r=new Date(n.valueOf()-a/2),l=new Date(n.valueOf()+a/2);return this.setVisibleChartRange(r,l),!0}}}else this.unselectItem();return!1},links.Timeline.prototype.getSelection=function(){var e=[];return this.selection&&e.push({row:this.selection.index}),e},links.Timeline.prototype.selectItem=function(e){if(this.unselectItem(),this.selection=void 0,void 0!==this.items[e]){var t=this.items[e],i=t.dom;this.selection={index:e,item:i},this.isEditable(t)&&(i.style.cursor="move"),t.select(),this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.isSelected=function(e){return this.selection&&this.selection.index===e},links.Timeline.prototype.unselectItem=function(){if(this.selection){var e=this.items[this.selection.index];if(e&&e.dom){var t=e.dom;t.style.cursor="",e.unselect()}this.selection=void 0,this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.stackItems=function(e){if(!(this.groups.length>0)){void 0==e&&(e=!1);var t=this.stack;if(t||(t={},this.stack=t),t.sortedItems=this.stackOrder(this.visibleItems),t.finalItems=this.stackCalculateFinal(t.sortedItems),e||t.timer){var i=this,n=function(){var e=i.stackMoveOneStep(t.sortedItems,t.finalItems);i.repaint(),e?delete t.timer:t.timer=setTimeout(n,30)};t.timer||(t.timer=setTimeout(n,30))}else this.stackMoveToFinal(t.sortedItems,t.finalItems)}},links.Timeline.prototype.stackCancelAnimation=function(){this.stack&&this.stack.timer&&(clearTimeout(this.stack.timer),delete this.stack.timer)},links.Timeline.prototype.stackOrder=function(e){var t=e.concat([]),i=function(e,t){return e instanceof links.Timeline.ItemRange&&!(t instanceof links.Timeline.ItemRange)?-1:!(e instanceof links.Timeline.ItemRange)&&t instanceof links.Timeline.ItemRange?1:e.left-t.left};return t.sort(i),t},links.Timeline.prototype.stackCalculateFinal=function(e){var t,i,n=this.size,s=n.axis.top,o=n.axis.height,a=this.options,r=a.axisOnTop,l=a.eventMargin,h=a.eventMarginAxis,m=[];for(t=0,i=e.length;i>t;t++){var p,c,d,u,g=e[t],f=g.height,v=g.width;p=r?o+h+l/2:s-f-h-l/2,u=p+f,g instanceof links.Timeline.ItemBox?(c=this.timeToScreen(g.start)-v/2,d=c+v):(g instanceof links.Timeline.ItemRange||g instanceof links.Timeline.ItemDot)&&(c=this.timeToScreen(g.start),d=g.end?this.timeToScreen(g.end):c+v),m[t]={left:c,top:p,right:d,bottom:u,height:f,item:g}}if(this.options.stackEvents)for(t=0,i=m.length;i>t;t++){var T=m[t],k=null;do k=this.stackItemsCheckOverlap(m,t,0,t-1),null!=k&&(T.top=r?k.top+k.height+l:k.top-T.height-l,T.bottom=T.top+T.height);while(k)}return m},links.Timeline.prototype.stackMoveOneStep=function(e,t){var n=!0;for(i=0,iMax=e.length;iMax>i;i++){var s=t[i],o=s.item,a=parseInt(o.top),r=parseInt(s.top),l=r-a;if(l){var h=r==a?0:r>a?1:-1;Math.abs(l)>4&&(h=l/4);var m=parseInt(a+h);m!=r&&(n=!1),o.top=m,o.bottom=o.top+o.height}else o.top=s.top,o.bottom=s.bottom;o.left=s.left,o.right=s.right}return n},links.Timeline.prototype.stackMoveToFinal=function(e,t){for(i=0,iMax=e.length;iMax>i;i++){var n=e[i],s=t[i];n.left=s.left,n.top=s.top,n.right=s.right,n.bottom=s.bottom}},links.Timeline.prototype.stackItemsCheckOverlap=function(e,t,i,n){for(var s=this.options.eventMargin,o=this.collision,a=e[t],r=n;r>=i;r--){var l=e[r];if(o(a,l,s)&&r!=t)return l}return void 0},links.Timeline.prototype.collision=function(e,t,i){return void 0==i&&(i=0),e.left-i<t.right&&e.right+i>t.left&&e.top-i<t.bottom&&e.bottom+i>t.top},links.Timeline.prototype.trigger=function(e){var t=null;switch(e){case"rangechange":case"rangechanged":t={start:new Date(this.start),end:new Date(this.end)};break;case"timechange":case"timechanged":t={time:new Date(this.customTime)}}links.events.trigger(this,e,t),google&&google.visualization&&google.visualization.events.trigger(this,e,t)},links.Timeline.prototype.filterItems=function(){var e,t=this,i=this.items,n=this.size,s=n.contentWidth,o=[];this.visibleItems=o;for(var a=0,r=i.length;r>a;a++){var l=i[a];l.updateVisible(this),l.visible&&o.push(l)}var h=this.clusterFactory.getClusters(this.conversion.factor);h.forEach(function(i){e=t.timeToScreen(i.start),i.visible=e+i.width/2>-s&&2*s>e-i.width/2,i.visible&&o.push(i)})},links.Timeline.ClusterFactory=function(e){this.timeline=e,this.clear()},links.Timeline.ClusterFactory.prototype.clear=function(){this.clearCache(),this.sortedItems=[]},links.Timeline.ClusterFactory.prototype.clearCache=function(){this.cache={},this.cacheLevel=-1,this.cache[this.cacheLevel]=[],this.cacheValid=!0},links.Timeline.ClusterFactory.prototype.invalidateCache=function(){this.cacheValid=!1},links.Timeline.ClusterFactory.prototype.setData=function(e){e=e||[];var t={};this.groups=t,e.forEach(function(e){var i=e.group?e.group.content:"",n=t[i];n||(n=[],t[i]=n),n.push(e)});for(var i in t)t.hasOwnProperty(i)&&t[i].sort(function(e,t){return e.center-t.center})},links.Timeline.ClusterFactory.prototype.getClusters=function(e){var t=-1,i=2,n=0,s=5;e>0&&(t=Math.round(Math.log(100/e)/Math.log(i)),n=Math.pow(i,t),this.timeline.groups&&this.timeline.groups.length&&(n*=4)),this.cacheValid||t==this.cacheLevel||(this.clearCache(),console.log("cache cleared...")),this.cacheLevel=t;var o=this.cache[t];if(!o){o=[];for(var a in this.groups)if(this.groups.hasOwnProperty(a))for(var r=this.groups[a],l=r.length,h=0;l>h;){for(var m=r[h],p=1,c=h-1;c>=0&&n/2>m.center-r[c].center;)r[c].cluster||p++,c--;for(var d=h+1;r.length>d&&n/2>r[d].center-m.center;)p++,d++;for(var u=o.length-1;u>=0&&n/2>m.center-o[u].center;)m.group==o[u].group&&p++,u--;if(p>s){for(var g=p-s+1,f=[],v=void 0,T=void 0,k=void 0,y=!1,D=0,x=h;g>f.length&&r.length>x;){var S=r[x],M=S.start.valueOf(),C=S.end?S.end.valueOf():S.start.valueOf();f.push(S),v=D?D/(D+1)*v+1/(D+1)*S.center:S.center,T=void 0!=T?Math.min(T,M):M,k=void 0!=k?Math.max(k,C):C,y=y||S instanceof links.Timeline.ItemRange,D++,x++}var I,w="Cluster containing "+D+" events. Zoom in to see the individual events.",E='<div title="'+w+'">'+D+" events</div>",b=m.group?m.group.content:void 0;I=y?this.timeline.createItem({start:new Date(T),end:new Date(k),content:E,group:b}):this.timeline.createItem({start:new Date(v),content:E,group:b}),I.isCluster=!0,I.items=f,I.items.forEach(function(e){e.cluster=I}),o.push(I),h+=g}else delete m.cluster,h+=1}this.cache[t]=o}return o},links.events=links.events||{listeners:[],indexOf:function(e){for(var t=this.listeners,i=0,n=this.listeners.length;n>i;i++){var s=t[i];if(s&&s.object==e)return i}return-1},addListener:function(e,t,i){var n=this.indexOf(e),s=this.listeners[n];s||(s={object:e,events:{}},this.listeners.push(s));var o=s.events[t];o||(o=[],s.events[t]=o),-1==o.indexOf(i)&&o.push(i)},removeListener:function(e,t,i){var n=this.indexOf(e),s=this.listeners[n];if(s){var o=s.events[t];if(o){var n=o.indexOf(i);-1!=n&&o.splice(n,1),0==o.length&&delete s.events[t]}var a=0,r=s.events;for(var l in r)r.hasOwnProperty(l)&&a++;0==a&&delete this.listeners[n]}},removeAllListeners:function(){this.listeners=[]},trigger:function(e,t,i){var n=this.indexOf(e),s=this.listeners[n];if(s){var o=s.events[t];if(o)for(var a=0,r=o.length;r>a;a++)o[a](i)}}},links.Timeline.StepDate=function(e,t,i){this.current=new Date,this._start=new Date,this._end=new Date,this.autoScale=!0,this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1,this.setRange(e,t,i)},links.Timeline.StepDate.SCALE={MILLISECOND:1,SECOND:2,MINUTE:3,HOUR:4,DAY:5,WEEKDAY:6,MONTH:7,YEAR:8},links.Timeline.StepDate.prototype.setRange=function(e,t,i){isNaN(e)||isNaN(t)||(this._start=void 0!=e?new Date(e):new Date,this._end=void 0!=t?new Date(t):new Date,this.autoScale&&this.setMinimumStep(i))},links.Timeline.StepDate.prototype.start=function(){this.current=new Date(this._start),this.roundToMinor()},links.Timeline.StepDate.prototype.roundToMinor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.step*Math.floor(this.current.getFullYear()/this.step)),this.current.setMonth(0);case links.Timeline.StepDate.SCALE.MONTH:this.current.setDate(1);case links.Timeline.StepDate.SCALE.DAY:case links.Timeline.StepDate.SCALE.WEEKDAY:this.current.setHours(0);case links.Timeline.StepDate.SCALE.HOUR:this.current.setMinutes(0);case links.Timeline.StepDate.SCALE.MINUTE:this.current.setSeconds(0);case links.Timeline.StepDate.SCALE.SECOND:this.current.setMilliseconds(0)}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.setMilliseconds(this.current.getMilliseconds()-this.current.getMilliseconds()%this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()-this.current.getSeconds()%this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()-this.current.getMinutes()%this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()-this.current.getHours()%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()-1-(this.current.getDate()-1)%this.step+1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()-this.current.getMonth()%this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()-this.current.getFullYear()%this.step);break;default:}},links.Timeline.StepDate.prototype.end=function(){return this.current.getTime()>this._end.getTime()},links.Timeline.StepDate.prototype.next=function(){var e=this.current.getTime();if(6>this.current.getMonth())switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.getTime()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current=new Date(this.current.getTime()+1e3*this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current=new Date(this.current.getTime()+60*1e3*this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current=new Date(this.current.getTime()+60*60*1e3*this.step);var t=this.current.getHours();this.current.setHours(t-t%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step);break;default:}else switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.getTime()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()+this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()+this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()+this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step);break;default:}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.getMilliseconds()<this.step&&this.current.setMilliseconds(0);
break;case links.Timeline.StepDate.SCALE.SECOND:this.current.getSeconds()<this.step&&this.current.setSeconds(0);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.getMinutes()<this.step&&this.current.setMinutes(0);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.getHours()<this.step&&this.current.setHours(0);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.getDate()<this.step+1&&this.current.setDate(1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.getMonth()<this.step&&this.current.setMonth(0);break;case links.Timeline.StepDate.SCALE.YEAR:break;default:}this.current.getTime()==e&&(this.current=new Date(this._end))},links.Timeline.StepDate.prototype.getCurrent=function(){return this.current},links.Timeline.StepDate.prototype.setScale=function(e,t){this.scale=e,t>0&&(this.step=t),this.autoScale=!1},links.Timeline.StepDate.prototype.setAutoScale=function(e){this.autoScale=e},links.Timeline.StepDate.prototype.setMinimumStep=function(e){if(void 0!=e){var t=31104e6,i=2592e6,n=864e5,s=36e5,o=6e4,a=1e3,r=1;1e3*t>e&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1e3),500*t>e&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=500),100*t>e&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=100),50*t>e&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=50),10*t>e&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=10),5*t>e&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=5),t>e&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1),3*i>e&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=3),i>e&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=1),5*n>e&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=5),2*n>e&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=2),n>e&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1),n/2>e&&(this.scale=links.Timeline.StepDate.SCALE.WEEKDAY,this.step=1),4*s>e&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=4),s>e&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=1),15*o>e&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=15),10*o>e&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=10),5*o>e&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=5),o>e&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=1),15*a>e&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=15),10*a>e&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=10),5*a>e&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=5),a>e&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=1),200*r>e&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=200),100*r>e&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=100),50*r>e&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=50),10*r>e&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=10),5*r>e&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=5),r>e&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=1)}},links.Timeline.StepDate.prototype.snap=function(e){if(this.scale==links.Timeline.StepDate.SCALE.YEAR){var t=e.getFullYear()+Math.round(e.getMonth()/12);e.setFullYear(Math.round(t/this.step)*this.step),e.setMonth(0),e.setDate(0),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MONTH)e.getDate()>15?(e.setDate(1),e.setMonth(e.getMonth()+1)):e.setDate(1),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0);else if(this.scale==links.Timeline.StepDate.SCALE.DAY||this.scale==links.Timeline.StepDate.SCALE.WEEKDAY){switch(this.step){case 5:case 2:e.setHours(24*Math.round(e.getHours()/24));break;default:e.setHours(12*Math.round(e.getHours()/12))}e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.HOUR){switch(this.step){case 4:e.setMinutes(60*Math.round(e.getMinutes()/60));break;default:e.setMinutes(30*Math.round(e.getMinutes()/30))}e.setSeconds(0),e.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MINUTE){switch(this.step){case 15:case 10:e.setMinutes(5*Math.round(e.getMinutes()/5)),e.setSeconds(0);break;case 5:e.setSeconds(60*Math.round(e.getSeconds()/60));break;default:e.setSeconds(30*Math.round(e.getSeconds()/30))}e.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.SECOND)switch(this.step){case 15:case 10:e.setSeconds(5*Math.round(e.getSeconds()/5)),e.setMilliseconds(0);break;case 5:e.setMilliseconds(1e3*Math.round(e.getMilliseconds()/1e3));break;default:e.setMilliseconds(500*Math.round(e.getMilliseconds()/500))}else if(this.scale==links.Timeline.StepDate.SCALE.MILLISECOND){var i=this.step>5?this.step/2:1;e.setMilliseconds(Math.round(e.getMilliseconds()/i)*i)}},links.Timeline.StepDate.prototype.isMajor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return 0==this.current.getMilliseconds();case links.Timeline.StepDate.SCALE.SECOND:return 0==this.current.getSeconds();case links.Timeline.StepDate.SCALE.MINUTE:return 0==this.current.getHours()&&0==this.current.getMinutes();case links.Timeline.StepDate.SCALE.HOUR:return 0==this.current.getHours();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return 1==this.current.getDate();case links.Timeline.StepDate.SCALE.MONTH:return 0==this.current.getMonth();case links.Timeline.StepDate.SCALE.YEAR:return!1;default:return!1}},links.Timeline.StepDate.prototype.getLabelMinor=function(e){var t=["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],i=["zo","ma","di","wo","do","vr","za"];switch(void 0==e&&(e=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return e.getMilliseconds()+"";case links.Timeline.StepDate.SCALE.SECOND:return e.getSeconds()+"";case links.Timeline.StepDate.SCALE.MINUTE:return this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2);case links.Timeline.StepDate.SCALE.HOUR:return this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2);case links.Timeline.StepDate.SCALE.WEEKDAY:return i[e.getDay()]+" "+e.getDate();case links.Timeline.StepDate.SCALE.DAY:return e.getDate()+"";case links.Timeline.StepDate.SCALE.MONTH:return t[e.getMonth()];case links.Timeline.StepDate.SCALE.YEAR:return e.getFullYear()+"";default:return""}},links.Timeline.StepDate.prototype.getLabelMajor=function(e){var t=["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],i=["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"];switch(void 0==e&&(e=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2)+":"+this.addZeros(e.getSeconds(),2);case links.Timeline.StepDate.SCALE.SECOND:return e.getDate()+" "+t[e.getMonth()]+" "+this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2);case links.Timeline.StepDate.SCALE.MINUTE:return i[e.getDay()]+" "+e.getDate()+" "+t[e.getMonth()]+" "+e.getFullYear();case links.Timeline.StepDate.SCALE.HOUR:return i[e.getDay()]+" "+e.getDate()+" "+t[e.getMonth()]+" "+e.getFullYear();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return t[e.getMonth()]+" "+e.getFullYear();case links.Timeline.StepDate.SCALE.MONTH:return e.getFullYear()+"";default:return""}},links.Timeline.StepDate.prototype.addZeros=function(e,t){for(var i=""+e;t>i.length;)i="0"+i;return i},links.imageloader=function(){function e(e){if(1==o[e])return!0;var t=new Image;return t.src=e,t.complete?!0:!1}function t(e){return void 0!=a[e]}function i(i,n,s){if(void 0==s&&(s=!0),e(i))return s&&n(i),void 0;if(!t(i)||s){var r=a[i];if(!r){var l=new Image;l.src=i,r=[],a[i]=r,l.onload=function(){o[i]=!0,delete a[i];for(var e=0;r.length>e;e++)r[e](i)}}-1==r.indexOf(n)&&r.push(n)}}function n(t,n,s){var o=[];if(t.forEach(function(t){e(t)||o.push(t)}),o.length){var a=o.length;o.forEach(function(e){i(e,function(){a--,0==a&&n()},s)})}else s&&n()}function s(e,t){for(var i=e.firstChild;i;){if("IMG"==i.tagName){var n=i.src;-1==t.indexOf(n)&&t.push(n)}s(i,t),i=i.nextSibling}}var o={},a={};return{isLoaded:e,isLoading:t,load:i,loadAll:n,filterImageUrls:s}}(),links.Timeline.addEventListener=function(e,t,i,n){e.addEventListener?(void 0===n&&(n=!1),"mousewheel"===t&&navigator.userAgent.indexOf("Firefox")>=0&&(t="DOMMouseScroll"),e.addEventListener(t,i,n)):e.attachEvent("on"+t,i)},links.Timeline.removeEventListener=function(e,t,i,n){e.removeEventListener?(void 0===n&&(n=!1),"mousewheel"===t&&navigator.userAgent.indexOf("Firefox")>=0&&(t="DOMMouseScroll"),e.removeEventListener(t,i,n)):e.detachEvent("on"+t,i)},links.Timeline.getTarget=function(e){e||(e=window.event);var t;return e.target?t=e.target:e.srcElement&&(t=e.srcElement),void 0!==t.nodeType&&3==t.nodeType&&(t=t.parentNode),t},links.Timeline.stopPropagation=function(e){e||(e=window.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},links.Timeline.preventDefault=function(e){e||(e=window.event),e.preventDefault?e.preventDefault():e.returnValue=!1},links.Timeline.getAbsoluteLeft=function(e){for(var t=0;null!=e;)t+=e.offsetLeft,t-=e.scrollLeft,e=e.offsetParent;return!document.body.scrollLeft&&window.pageXOffset&&(t-=window.pageXOffset),t},links.Timeline.getAbsoluteTop=function(e){for(var t=0;null!=e;)t+=e.offsetTop,t-=e.scrollTop,e=e.offsetParent;return!document.body.scrollTop&&window.pageYOffset&&(t-=window.pageYOffset),t},links.Timeline.addClassName=function(e,t){var i=e.className.split(" ");-1==i.indexOf(t)&&(i.push(t),e.className=i.join(" "))},links.Timeline.removeClassName=function(e,t){var i=e.className.split(" "),n=i.indexOf(t);-1!=n&&(i.splice(n,1),e.className=i.join(" "))},links.Timeline.isArray=function(e){return e instanceof Array?!0:"[object Array]"===Object.prototype.toString.call(e)};