<section id="planboard" ng-controller="timeline"><div class="page-header"><h2>{{ui.planboard.planboard}}</h2><div class="btn-group pull-right"><div class="btn-group"><button type="submit" ng-click="toggleSlotForm()" class="btn btn-success {{(views.slot.add==true) && 'active'}}">{{ui.planboard.newAvail}}</button> <button class="btn btn-success dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button><ul class="dropdown-menu fast-availability" style="right:0; font-size: 13px"><li><a ng-click="setAvailability(true, 1)"><div class="square available"></div>Beschikbaar (1 uur)</a></li><li><a ng-click="setAvailability(true, 6)"><div class="square available"></div>Beschikbaar (6 uur)</a></li><li><a ng-click="setAvailability(true, 24)"><div class="square available"></div>Beschikbaar (24 uur)</a></li><li class="divider"></li><li><a ng-click="setAvailability(false, 1)"><div class="square unavailable"></div>Niet beschikbaar (1 uur)</a></li><li><a ng-click="setAvailability(false, 6)"><div class="square unavailable"></div>Niet beschikbaar (6 uur)</a></li><li><a ng-click="setAvailability(false, 24)"><div class="square unavailable"></div>Niet beschikbaar (24 uur)</a></li></ul></div></div></div><div class="row-fluid" id="timeline-controls" ng-controller="timeline-navigation"><div class="pull-left" style="margin-top: 10px"><div class="control-group pull-left" style="margin-right: 10px"><input type="text" style="width: 190px" name="daterange" ng-model="daterange" daterangepicker=""><i class="icon-calendar" style="position: relative; margin: -3px 0 0 -24px"></i></div><div class="btn-group pull-left" style="margin-right: 5px"><button type="button" ng-model="timeline.scope.day" class="btn {{(timeline.scope.day==true) && 'active'}}" ng-click="timelineScoper('day')">{{ui.planboard.day}}</button> <button type="button" ng-model="timeline.scope.week" class="btn {{(timeline.scope.week==true) && 'active'}}" ng-click="timelineScoper('week')">{{ui.planboard.week}}</button> <button type="button" ng-model="timeline.scope.month" class="btn {{(timeline.scope.month==true) && 'active'}}" ng-click="timelineScoper('month')">{{ui.planboard.month}}</button></div><div class="btn-group pull-left" style="margin-right: 5px"><button type="button" id="timelineBeforeBtn" class="btn" ng-click="timelineBefore(timeline.scope)"><i class="icon-arrow-left"></i></button> <button type="button" id="timelineZoomInBtn" class="btn" ng-click="timelineZoomIn()"><i class="icon-zoom-in"></i></button> <button type="button" id="timelineZoomOutBtn" class="btn" ng-click="timelineZoomOut()"><i class="icon-zoom-out"></i></button> <button type="button" id="timelineAfterBtn" class="btn" ng-click="timelineAfter(timeline.scope)"><i class="icon-arrow-right"></i></button></div></div><div class="{{ (browser.mobile) && 'pull-left' || 'pull-right' }}" style="text-align: {{(browser.mobile) &&  'left' || 'right' }}"><h4 style="font-weight: normal">{{timeline.range | rangeMainFilter}}<br><div style="font-size: 15px; font-weight: lighter"><span>{{timeline | rangeInfoFilter}}</span></div></h4></div></div><div class="row-fluid" ng-show="views.slot.add || views.slot.edit || views.group || views.wish || views.member"><form class="form-inline form-toggled well"><button ng-click="resetInlineForms()" class="close">&times;</button> <h4 ng-show="views.slot.add">{{ui.planboard.newAvail}}</h4><h4 ng-show="views.slot.edit">{{ui.planboard.updateAvail}}</h4><h4 ng-show="views.group">{{slot.group|stripHtml}}</h4><h4 ng-show="views.wish">{{slot.group|stripHtml}} (Wishes)</h4><h4 ng-show="views.member">{{slot.member|convertUserIdToName}}</h4><hr><div class="form-elements-group" ng-show="browser.mobile"><label>{{ui.planboard.from}}</label><div class="control-group dater-mobile" ng-show="views.slot.add || views.slot.edit || views.wish"><input name="date-start" type="datetime-local" ng-model="slot.start.datetime"></div><div class="control-group dater-mobile" ng-show="views.group || views.member"><input name="date-start" type="datetime-local" ng-model="slot.start.datetime" disabled="disabled"></div></div><div class="form-elements-group" ng-hide="browser.mobile"><label>{{ui.planboard.from}}</label><div class="control-group dater" ng-show="views.slot.add || views.slot.edit || views.wish"><input name="date-start" type="text" ng-model="slot.start.date" data-date-format="dd-mm-yyyy" bs-datepicker=""><i class="icon-calendar"></i></div><div class="control-group dater" ng-show="views.group || views.member"><input name="date-start" type="text" ng-model="slot.start.date" disabled="disabled"><i class="icon-calendar"></i></div><div class="control-group timer" ng-show="views.slot.add || views.slot.edit || views.wish"><input name="time-start" type="text" ng-model="slot.start.time" bs-timepicker=""><i class="icon-time"></i></div><div class="control-group timer" ng-show="views.group || views.member"><input name="time-start" type="text" ng-model="slot.start.time" disabled="disabled"><i class="icon-time"></i></div></div><div class="form-elements-group" ng-show="browser.mobile"><label>{{ui.planboard.till}}</label><div class="control-group dater-mobile" ng-show="views.slot.add || views.slot.edit || views.wish"><input name="date-start" type="datetime-local" ng-model="slot.end.datetime"></div><div class="control-group dater-mobile" ng-show="views.group || views.member"><input name="date-start" type="datetime-local" ng-model="slot.end.datetime" disabled="disabled"></div><br><br></div><div class="form-elements-group" ng-hide="browser.mobile"><label>{{ui.planboard.till}}</label><div class="control-group dater" ng-show="views.slot.add || views.slot.edit || views.wish"><input name="date-end" type="text" ng-model="slot.end.date" data-date-format="dd-mm-yyyy" bs-datepicker=""><i class="icon-calendar"></i></div><div class="control-group dater" ng-show="views.group || views.member"><input name="date-end" type="text" ng-model="slot.end.date" disabled="disabled"><i class="icon-calendar"></i></div><div class="control-group timer" ng-show="views.slot.add || views.slot.edit || views.wish"><input name="time-end" type="text" ng-model="slot.end.time" bs-timepicker=""><i class="icon-time"></i></div><div class="control-group timer" ng-show="views.group || views.member"><input name="time-end" type="text" ng-model="slot.end.time" disabled="disabled"><i class="icon-time"></i></div></div><div class="form-elements-group" ng-show="views.slot.add || views.slot.edit || views.member"><label>{{ui.planboard.state}}</label><select ng-model="slot.state" ng-options="option as value for (option, value) in states" ng-change="modifySlot(slot)" ng-show="views.slot.add || views.slot.edit"></select><select ng-model="slot.state" disabled="disabled" ng-options="option as value for (option, value) in states" ng-show="views.member"></select></div><div class="form-elements-group rightest" ng-show="views.slot.add || views.slot.edit"><label>{{ui.planboard.reoccuring}}</label><input type="checkbox" ng-model="slot.recursive"></div><div class="form-elements-group" ng-show="views.group"><small><i ng-show="(slot.diff < 0)">{{slot.diff | i18n_spec:'planboard.lessPeople'}}</i> <i ng-show="(slot.diff == 0)">{{ui.planboard.samePeople}}</i> <i ng-show="(slot.diff > 0)">{{slot.diff | i18n_spec:'planboard.morePeople'}}</i></small></div><div class="form-elements-group" ng-show="views.wish"><label>{{ui.planboard.wished}}</label><input name="wish-count" type="text" class="input-mini" ng-model="slot.wish" ng-hide="app.resources.role > 1"><input name="wish-count" type="text" class="input-mini" ng-model="slot.wish" disabled="disabled" ng-show="app.resources.role > 1"></div><div class="form-elements-group" ng-show="views.member"><small><i>{{ui.planboard.combine_reoccuring}}</i></small></div><div class="form-elements-actions pull-right"><div ng-show="(slot.diff < 0)"><button type="button" ng-click="sendShortageMessage(slot)" class="btn btn-success" ng-hide="app.resources.role > 1">{{ui.planboard.sendMsgToMember}}</button></div><div ng-show="views.slot.add"><button type="button" ng-click="timelineOnAdd('true', slot)" class="btn btn-success">{{ui.planboard.add}}</button></div><div ng-show="views.slot.edit"><button type="button" ng-click="timelineOnRemove()" class="btn btn-danger" style="margin-right: 5px">{{ui.planboard.del}}</button> <button type="button" ng-click="timelineOnChange('true', original, slot)" class="btn btn-success">{{ui.planboard.change}}</button></div><div ng-show="views.wish"><button type="button" ng-click="wisher(slot)" class="btn btn-success" ng-hide="app.resources.role > 1">{{ui.planboard.setWish}}</button></div></div></form></div><div class="row-fluid"><div class="tabbable tabs-left"><ul class="nav nav-tabs nav-tabs-app" style="margin-right: 0px"><li class="active"><a href="#timelineTab" data-toggle="tab" ng-click="destroy.statistics();"><span class="entypo">&#128340;</span> {{ui.planboard.timeline}}</a></li><li><a href="#statisticsTab" data-toggle="tab" ng-click="destroy.timeline();"><span class="entypo">&#128200;</span> {{ui.planboard.statistics}}</a></li></ul><div class="tab-content"><div class="tab-pane active" id="timelineTab"><div id="timeline"><div id="timeline-toolbar" style="{{ (browser.mobile) && 'height: auto' }}"><div class="pull-left"><select ng-model="timeline.current.group" ng-options="group.uuid as group.name for group in groups" ng-selected="timeline.current.group" ng-change="requestTimeline()" ng-show="timeline.current.layouts.group"></select><select ng-model="timeline.current.division" ng-options="division.id as division.label for division in divisions" ng-selected="timeline.current.division" ng-change="changeDivision()" ng-show="divisions.length > 0"></select></div><br ng-show="browser.mobile"><br ng-show="browser.mobile"><div class="{{ (browser.mobile) && 'pull-left' || 'pull-right' }}" style="{{ (browser.mobile) && 'margin-left: -10px;' }}"><div class="btn-group"><button type="button" ng-click="showLegenda()" class="btn {{(timeline.config.legendarer==true) && 'active'}}" ng-model="timeline.config.legendarer">{{ui.planboard.legenda}}</button></div><div class="btn-group" ng-show="timeline.current.layouts.group"><button type="button" ng-click="barCharts()" class="btn {{(timeline.config.bar==true) && 'active'}}" ng-model="timeline.config.bar">{{ui.planboard.barCharts}}</button></div><div class="btn-group" ng-show="timeline.current.layouts.group"><button type="button" ng-click="groupWishes()" class="btn {{(timeline.config.wishes==true) && 'active'}}" ng-model="timeline.config.wishes">{{ui.planboard.wishes}}</button></div><div class="btn-group"><button type="button" ng-model="timeline.current.layouts.group" class="btn {{(timeline.current.layouts.group==true) && 'active'}}" ng-click="requestTimeline('group')">{{ui.planboard.group}}</button> <button type="button" ng-model="timeline.current.layouts.members" class="btn {{(timeline.current.layouts.members==true) && 'active'}}" ng-click="requestTimeline('members')" ng-show="(app.resources.role < 3) || timeline.config.layouts.members">{{ui.planboard.members}}</button></div></div></div><hr><div class="alert alert-warning" ng-show="registeredNotifications.timeLineDragging"><button type="button" class="close" ng-click="registerNotification('timeLineDragging', false)" data-dismiss="alert">&times;</button> <small>U kunt ook uw <strong><i>beschikbaarheid wijzigen</i></strong> door te dubbelklikken op reeds bestaande blokken of <strong><i>door te slepen</i></strong> met uw muis met de linkermuisknop en de <strong>SHIFT (Mac)</strong> of <strong>CTRL (Windows)</strong> knop tegelijkertijd ingedrukt.</small></div><div class="legenda" ng-show="timeline.config.legendarer"><div class="legenda-row"><strong>{{ui.planboard.members}}</strong><ul><li ng-repeat="(key, value) in timeline.config.states" class="legenda-{{value.className}}"><label><div class="square"></div><input type="checkbox" ng-click="alterLegenda(timeline.config.legenda)" ng-model="timeline.config.legenda[key]">{{value.label}}</label></li></ul></div><div class="legenda-row last-legenda-row"><strong>{{ui.planboard.groups}}</strong><ul><li class="legenda-more"><label><div class="square"></div><input type="checkbox" ng-click="alterLegenda(timeline.config.legenda)" ng-model="timeline.config.legenda.groups.more">{{ui.planboard.legendaLabels.morePeople}}</label></li><li class="legenda-even"><label><div class="square"></div><input type="checkbox" ng-click="alterLegenda(timeline.config.legenda)" ng-model="timeline.config.legenda.groups.even">{{ui.planboard.legendaLabels.enoughPeople}}</label></li><li class="legenda-less"><label><div class="square"></div><input type="checkbox" ng-click="alterLegenda(timeline.config.legenda)" ng-model="timeline.config.legenda.groups.less">{{ui.planboard.legendaLabels.lessPeople}}</label></li></ul></div><hr></div><div id="mainTimeline"></div></div><hr><p><small class="pull-left"><span class="text-warning">{{ui.planboard.lastSyncTime}}</span>&nbsp; <span class="muted">{{data.synced | nicelyDate}}</span></small> <small class="pull-right"><span class="text-warning">{{ui.planboard.dataRangeStart}}</span> <span class="muted">{{data.periods.start | nicelyDate}}</span> &nbsp;|&nbsp; <span class="text-warning">{{ui.planboard.dataRangeEnd}}</span> <span class="muted">{{data.periods.end | nicelyDate}}</span></small></p></div><div class="tab-pane" id="statisticsTab"><div id="timeline-toolbar"><div class="pull-left"><select ng-model="timeline.current.group" ng-options="group.uuid as group.name for group in groups" ng-selected="timeline.current.group" ng-change="requestTimeline()"></select><select ng-model="timeline.current.division" ng-options="division.id as division.label for division in divisions" ng-selected="timeline.current.division" ng-change="changeDivision()" ng-show="divisions.length > 0"></select></div><div class="pull-right"><div class="btn-group"><button type="button" ng-model="timeline.current.layouts.group" class="btn {{(timeline.current.layouts.group==true) && 'active'}}" ng-click="requestTimeline('group')">{{ui.planboard.group}}</button> <button type="button" ng-model="timeline.current.layouts.members" class="btn {{(timeline.current.layouts.members==true) && 'active'}}" ng-click="requestTimeline('members')" ng-show="(app.resources.role < 3) || timeline.config.layouts.members">{{ui.planboard.members}}</button></div></div></div><hr><div class="legenda"><div class="legenda-row"><strong>{{ui.planboard.members}}</strong><ul><li ng-repeat="(key, value) in timeline.config.states" class="legenda-{{value.className}}"><label><div class="square"></div>{{value.label}}</label></li></ul></div><div class="legenda-row last-legenda-row"><strong>{{ui.planboard.groups}}</strong><ul><li class="legenda-more"><label><div class="square"></div>{{ui.planboard.legendaLabels.morePeople}}</label></li><li class="legenda-even"><label><div class="square"></div>{{ui.planboard.legendaLabels.enoughPeople}}</label></li><li class="legenda-less"><label><div class="square"></div>{{ui.planboard.legendaLabels.lessPeople}}</label></li></ul></div><hr></div><div id="stats"><div id="groupStats" ng-repeat="agg in data.aggs"><div ng-show="groupPieHide[agg.division.id] || (timeline.current.division == 'all')"><div id="groupPie-{{agg.division.id}}" class="groupPies"></div><div class="groupStatInfo"><h3>{{agg.id | groupIdToName}} <span ng-hide="!agg.division.label">&nbsp; ({{ agg.division.label }})</span></h3><hr><ul><li><div class="ratios more"><span class="ratio">{{agg.ratios.more}}</span> <span class="percentage">%</span></div><div class="info"><h4>{{ui.planboard.statPeopleMore}}</h4><h5>{{agg.durations.more | calculateTimeInDays}}</h5>&nbsp; <small class="muted">{{ui.planboard.statDays}}</small>,&nbsp;<h5>{{agg.durations.more | calculateTimeInHours}}</h5>&nbsp; <small class="muted">{{ui.planboard.statHours}}</small>,&nbsp;<h5>{{agg.durations.more | calculateTimeInMinutes}}</h5>&nbsp; <small class="muted">{{ui.planboard.statMinutes}}</small></div></li><li><div class="ratios even"><span class="ratio">{{agg.ratios.even}}</span> <span class="percentage">%</span></div><div class="info"><h4>{{ui.planboard.statPeopleEven}}</h4><h5>{{agg.durations.even | calculateTimeInDays}}</h5>&nbsp; <small class="muted">{{ui.planboard.statDays}}</small>,&nbsp;<h5>{{agg.durations.even | calculateTimeInHours}}</h5>&nbsp; <small class="muted">{{ui.planboard.statHours}}</small>,&nbsp;<h5>{{agg.durations.even | calculateTimeInMinutes}}</h5>&nbsp; <small class="muted">{{ui.planboard.statMinutes}}</small></div></li><li><div class="ratios less"><span class="ratio">{{agg.ratios.less}}</span> <span class="percentage">%</span></div><div class="info"><h4>{{ui.planboard.statPeopleLess}}</h4><h5>{{agg.durations.less | calculateTimeInDays}}</h5>&nbsp; <small class="muted">{{ui.planboard.statDays}}</small>,&nbsp;<h5>{{agg.durations.less | calculateTimeInHours}}</h5>&nbsp; <small class="muted">{{ui.planboard.statHours}}</small>,&nbsp;<h5>{{agg.durations.less | calculateTimeInMinutes}}</h5>&nbsp; <small class="muted">{{ui.planboard.statMinutes}}</small></div></li></ul></div></div></div><div id="memberBars"><ul><li ng-repeat="member in data.members"><h4>{{member.id | convertUserIdToName}}</h4><div class="progress"><div ng-repeat="stat in member.stats" class="bar {{stat.state}}" style="width: {{stat.ratio}}%"></div></div><small class="muted">{{member.stats | convertRatios}}</small></li></ul></div></div><hr><p><small class="pull-left"><span class="text-warning">{{ui.planboard.lastSyncTime}}</span>&nbsp; <span class="muted">{{data.synced | nicelyDate}}</span></small> <small class="pull-right"><span class="text-warning">{{ui.planboard.dataRangeStart}}</span> <span class="muted">{{data.periods.start | nicelyDate}}</span> &nbsp;|&nbsp; <span class="text-warning">{{ui.planboard.dataRangeEnd}}</span> <span class="muted">{{data.periods.end | nicelyDate}}</span></small></p></div></div></div></div></section>